{"remainingRequest":"/Users/justinwu/Desktop/story_personalization_system/node_modules/babel-loader/lib/index.js!/Users/justinwu/Desktop/story_personalization_system/node_modules/eslint-loader/index.js??ref--13-0!/Users/justinwu/Desktop/story_personalization_system/src/js/tiptap/packages/tiptap/src/Utils/ComponentView.js","dependencies":[{"path":"/Users/justinwu/Desktop/story_personalization_system/src/js/tiptap/packages/tiptap/src/Utils/ComponentView.js","mtime":1604692362851},{"path":"/Users/justinwu/Desktop/story_personalization_system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/justinwu/Desktop/story_personalization_system/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/justinwu/Desktop/story_personalization_system/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZW50cmllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9zdG9yeV9wZXJzb25hbGl6YXRpb25fc3lzdGVtL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy9qdXN0aW53dS9EZXNrdG9wL3N0b3J5X3BlcnNvbmFsaXphdGlvbl9zeXN0ZW0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy9qdXN0aW53dS9EZXNrdG9wL3N0b3J5X3BlcnNvbmFsaXphdGlvbl9zeXN0ZW0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9zdG9yeV9wZXJzb25hbGl6YXRpb25fc3lzdGVtL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBWdWUgZnJvbSAndnVlJzsKaW1wb3J0IHsgZ2V0TWFya1JhbmdlIH0gZnJvbSAndGlwdGFwLXV0aWxzJzsKCnZhciBDb21wb25lbnRWaWV3ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBDb21wb25lbnRWaWV3KGNvbXBvbmVudCwgX3JlZikgewogICAgdmFyIGVkaXRvciA9IF9yZWYuZWRpdG9yLAogICAgICAgIGV4dGVuc2lvbiA9IF9yZWYuZXh0ZW5zaW9uLAogICAgICAgIHBhcmVudCA9IF9yZWYucGFyZW50LAogICAgICAgIG5vZGUgPSBfcmVmLm5vZGUsCiAgICAgICAgdmlldyA9IF9yZWYudmlldywKICAgICAgICBkZWNvcmF0aW9ucyA9IF9yZWYuZGVjb3JhdGlvbnMsCiAgICAgICAgZ2V0UG9zID0gX3JlZi5nZXRQb3M7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbXBvbmVudFZpZXcpOwoKICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50OwogICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7CiAgICB0aGlzLmV4dGVuc2lvbiA9IGV4dGVuc2lvbjsKICAgIHRoaXMucGFyZW50ID0gcGFyZW50OwogICAgdGhpcy5ub2RlID0gbm9kZTsKICAgIHRoaXMudmlldyA9IHZpZXc7CiAgICB0aGlzLmRlY29yYXRpb25zID0gZGVjb3JhdGlvbnM7CiAgICB0aGlzLmlzTm9kZSA9ICEhdGhpcy5ub2RlLm1hcmtzOwogICAgdGhpcy5pc01hcmsgPSAhdGhpcy5pc05vZGU7CiAgICB0aGlzLmdldFBvcyA9IHRoaXMuaXNNYXJrID8gdGhpcy5nZXRNYXJrUG9zIDogZ2V0UG9zOwogICAgdGhpcy5jYXB0dXJlRXZlbnRzID0gdHJ1ZTsKICAgIHRoaXMuZG9tID0gdGhpcy5jcmVhdGVET00oKTsKICAgIHRoaXMuY29udGVudERPTSA9IHRoaXMudm0uJHJlZnMuY29udGVudDsKICB9CgogIF9jcmVhdGVDbGFzcyhDb21wb25lbnRWaWV3LCBbewogICAga2V5OiAiY3JlYXRlRE9NIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVET00oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgQ29tcG9uZW50ID0gVnVlLmV4dGVuZCh0aGlzLmNvbXBvbmVudCk7CiAgICAgIHZhciBwcm9wcyA9IHsKICAgICAgICBlZGl0b3I6IHRoaXMuZWRpdG9yLAogICAgICAgIG5vZGU6IHRoaXMubm9kZSwKICAgICAgICB2aWV3OiB0aGlzLnZpZXcsCiAgICAgICAgZ2V0UG9zOiBmdW5jdGlvbiBnZXRQb3MoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0UG9zKCk7CiAgICAgICAgfSwKICAgICAgICBkZWNvcmF0aW9uczogdGhpcy5kZWNvcmF0aW9ucywKICAgICAgICBzZWxlY3RlZDogZmFsc2UsCiAgICAgICAgb3B0aW9uczogdGhpcy5leHRlbnNpb24ub3B0aW9ucywKICAgICAgICB1cGRhdGVBdHRyczogZnVuY3Rpb24gdXBkYXRlQXR0cnMoYXR0cnMpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy51cGRhdGVBdHRycyhhdHRycyk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHR5cGVvZiB0aGlzLmV4dGVuc2lvbi5zZXRTZWxlY3Rpb24gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB0aGlzLnNldFNlbGVjdGlvbiA9IHRoaXMuZXh0ZW5zaW9uLnNldFNlbGVjdGlvbjsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiB0aGlzLmV4dGVuc2lvbi51cGRhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB0aGlzLnVwZGF0ZSA9IHRoaXMuZXh0ZW5zaW9uLnVwZGF0ZTsKICAgICAgfQoKICAgICAgdGhpcy52bSA9IG5ldyBDb21wb25lbnQoewogICAgICAgIHBhcmVudDogdGhpcy5wYXJlbnQsCiAgICAgICAgcHJvcHNEYXRhOiBwcm9wcwogICAgICB9KS4kbW91bnQoKTsKICAgICAgcmV0dXJuIHRoaXMudm0uJGVsOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlKG5vZGUsIGRlY29yYXRpb25zKSB7CiAgICAgIGlmIChub2RlLnR5cGUgIT09IHRoaXMubm9kZS50eXBlKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAobm9kZSA9PT0gdGhpcy5ub2RlICYmIHRoaXMuZGVjb3JhdGlvbnMgPT09IGRlY29yYXRpb25zKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHRoaXMubm9kZSA9IG5vZGU7CiAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSBkZWNvcmF0aW9uczsKICAgICAgdGhpcy51cGRhdGVDb21wb25lbnRQcm9wcyh7CiAgICAgICAgbm9kZTogbm9kZSwKICAgICAgICBkZWNvcmF0aW9uczogZGVjb3JhdGlvbnMKICAgICAgfSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZUNvbXBvbmVudFByb3BzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVDb21wb25lbnRQcm9wcyhwcm9wcykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICghdGhpcy52bS5fcHJvcHMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gVXBkYXRlIHByb3BzIGluIGNvbXBvbmVudAogICAgICAvLyBUT0RPOiBBdm9pZCBtdXRhdGluZyBhIHByb3AgZGlyZWN0bHkuCiAgICAgIC8vIE1heWJlIHRoZXJlIGlzIGEgYmV0dGVyIHdheSB0byBkbyB0aGlzPwoKCiAgICAgIHZhciBvcmlnaW5hbFNpbGVudCA9IFZ1ZS5jb25maWcuc2lsZW50OwogICAgICBWdWUuY29uZmlnLnNpbGVudCA9IHRydWU7CiAgICAgIE9iamVjdC5lbnRyaWVzKHByb3BzKS5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciBfcmVmMyA9IF9zbGljZWRUb0FycmF5KF9yZWYyLCAyKSwKICAgICAgICAgICAga2V5ID0gX3JlZjNbMF0sCiAgICAgICAgICAgIHZhbHVlID0gX3JlZjNbMV07CgogICAgICAgIF90aGlzMi52bS5fcHJvcHNba2V5XSA9IHZhbHVlOwogICAgICB9KTsgLy8gdGhpcy52bS5fcHJvcHMubm9kZSA9IG5vZGUKICAgICAgLy8gdGhpcy52bS5fcHJvcHMuZGVjb3JhdGlvbnMgPSBkZWNvcmF0aW9ucwoKICAgICAgVnVlLmNvbmZpZy5zaWxlbnQgPSBvcmlnaW5hbFNpbGVudDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVBdHRycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0cnMoYXR0cnMpIHsKICAgICAgaWYgKCF0aGlzLnZpZXcuZWRpdGFibGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBzdGF0ZSA9IHRoaXMudmlldy5zdGF0ZTsKICAgICAgdmFyIHR5cGUgPSB0aGlzLm5vZGUudHlwZTsKICAgICAgdmFyIHBvcyA9IHRoaXMuZ2V0UG9zKCk7CgogICAgICB2YXIgbmV3QXR0cnMgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMubm9kZS5hdHRycyksIGF0dHJzKTsKCiAgICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMuaXNNYXJrID8gc3RhdGUudHIucmVtb3ZlTWFyayhwb3MuZnJvbSwgcG9zLnRvLCB0eXBlKS5hZGRNYXJrKHBvcy5mcm9tLCBwb3MudG8sIHR5cGUuY3JlYXRlKG5ld0F0dHJzKSkgOiBzdGF0ZS50ci5zZXROb2RlTWFya3VwKHBvcywgbnVsbCwgbmV3QXR0cnMpOwogICAgICB0aGlzLnZpZXcuZGlzcGF0Y2godHJhbnNhY3Rpb24pOwogICAgfSAvLyBwcmV2ZW50IGEgZnVsbCByZS1yZW5kZXIgb2YgdGhlIHZ1ZSBjb21wb25lbnQgb24gdXBkYXRlCiAgICAvLyB3ZSdsbCBoYW5kbGUgcHJvcCB1cGRhdGVzIGluIGB1cGRhdGUoKWAKCiAgfSwgewogICAga2V5OiAiaWdub3JlTXV0YXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlnbm9yZU11dGF0aW9uKG11dGF0aW9uKSB7CiAgICAgIC8vIGFsbG93IGxlYWYgbm9kZXMgdG8gYmUgc2VsZWN0ZWQKICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdzZWxlY3Rpb24nKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuY29udGVudERPTSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gIXRoaXMuY29udGVudERPTS5jb250YWlucyhtdXRhdGlvbi50YXJnZXQpOwogICAgfSAvLyBkaXNhYmxlIChhbG1vc3QpIGFsbCBwcm9zZW1pcnJvciBldmVudCBsaXN0ZW5lciBmb3Igbm9kZSB2aWV3cwoKICB9LCB7CiAgICBrZXk6ICJzdG9wRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3BFdmVudChldmVudCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0eXBlb2YgdGhpcy5leHRlbnNpb24uc3RvcEV2ZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZXh0ZW5zaW9uLnN0b3BFdmVudChldmVudCk7CiAgICAgIH0KCiAgICAgIHZhciBkcmFnZ2FibGUgPSAhIXRoaXMuZXh0ZW5zaW9uLnNjaGVtYS5kcmFnZ2FibGU7IC8vIHN1cHBvcnQgYSBjdXN0b20gZHJhZyBoYW5kbGUKCiAgICAgIGlmIChkcmFnZ2FibGUgJiYgZXZlbnQudHlwZSA9PT0gJ21vdXNlZG93bicpIHsKICAgICAgICB2YXIgZHJhZ0hhbmRsZSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0ICYmIGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcmFnLWhhbmRsZV0nKTsKICAgICAgICB2YXIgaXNWYWxpZERyYWdIYW5kbGUgPSBkcmFnSGFuZGxlICYmICh0aGlzLmRvbSA9PT0gZHJhZ0hhbmRsZSB8fCB0aGlzLmRvbS5jb250YWlucyhkcmFnSGFuZGxlKSk7CgogICAgICAgIGlmIChpc1ZhbGlkRHJhZ0hhbmRsZSkgewogICAgICAgICAgdGhpcy5jYXB0dXJlRXZlbnRzID0gZmFsc2U7CiAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpczMuY2FwdHVyZUV2ZW50cyA9IHRydWU7CiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIG9uY2U6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGlzQ29weSA9IGV2ZW50LnR5cGUgPT09ICdjb3B5JzsKICAgICAgdmFyIGlzUGFzdGUgPSBldmVudC50eXBlID09PSAncGFzdGUnOwogICAgICB2YXIgaXNDdXQgPSBldmVudC50eXBlID09PSAnY3V0JzsKICAgICAgdmFyIGlzRHJhZyA9IGV2ZW50LnR5cGUuc3RhcnRzV2l0aCgnZHJhZycpIHx8IGV2ZW50LnR5cGUgPT09ICdkcm9wJzsKCiAgICAgIGlmIChkcmFnZ2FibGUgJiYgaXNEcmFnIHx8IGlzQ29weSB8fCBpc1Bhc3RlIHx8IGlzQ3V0KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5jYXB0dXJlRXZlbnRzOwogICAgfQogIH0sIHsKICAgIGtleTogInNlbGVjdE5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdE5vZGUoKSB7CiAgICAgIHRoaXMudXBkYXRlQ29tcG9uZW50UHJvcHMoewogICAgICAgIHNlbGVjdGVkOiB0cnVlCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImRlc2VsZWN0Tm9kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzZWxlY3ROb2RlKCkgewogICAgICB0aGlzLnVwZGF0ZUNvbXBvbmVudFByb3BzKHsKICAgICAgICBzZWxlY3RlZDogZmFsc2UKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TWFya1BvcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWFya1BvcygpIHsKICAgICAgdmFyIHBvcyA9IHRoaXMudmlldy5wb3NBdERPTSh0aGlzLmRvbSk7CiAgICAgIHZhciByZXNvbHZlZFBvcyA9IHRoaXMudmlldy5zdGF0ZS5kb2MucmVzb2x2ZShwb3MpOwogICAgICB2YXIgcmFuZ2UgPSBnZXRNYXJrUmFuZ2UocmVzb2x2ZWRQb3MsIHRoaXMubm9kZS50eXBlKTsKICAgICAgcmV0dXJuIHJhbmdlOwogICAgfQogIH0sIHsKICAgIGtleTogImRlc3Ryb3kiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICAgIHRoaXMudm0uJGRlc3Ryb3koKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDb21wb25lbnRWaWV3Owp9KCk7CgpleHBvcnQgeyBDb21wb25lbnRWaWV3IGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/Users/justinwu/Desktop/story_personalization_system/src/js/tiptap/packages/tiptap/src/Utils/ComponentView.js"],"names":["Vue","getMarkRange","ComponentView","component","editor","extension","parent","node","view","decorations","getPos","isNode","marks","isMark","getMarkPos","captureEvents","dom","createDOM","contentDOM","vm","$refs","content","Component","extend","props","selected","options","updateAttrs","attrs","setSelection","update","propsData","$mount","$el","type","updateComponentProps","_props","originalSilent","config","silent","Object","entries","forEach","key","value","editable","state","pos","newAttrs","transaction","tr","removeMark","from","to","addMark","create","setNodeMarkup","dispatch","mutation","contains","target","event","stopEvent","draggable","schema","dragHandle","closest","isValidDragHandle","document","addEventListener","once","isCopy","isPaste","isCut","isDrag","startsWith","posAtDOM","resolvedPos","doc","resolve","range","$destroy"],"mappings":"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","sourcesContent":["import Vue from 'vue'\n\nimport { getMarkRange } from 'tiptap-utils'\n\nexport default class ComponentView {\n\n  constructor(component, {\n    editor,\n    extension,\n    parent,\n    node,\n    view,\n    decorations,\n    getPos,\n  }) {\n    this.component = component\n    this.editor = editor\n    this.extension = extension\n    this.parent = parent\n    this.node = node\n    this.view = view\n    this.decorations = decorations\n    this.isNode = !!this.node.marks\n    this.isMark = !this.isNode\n    this.getPos = this.isMark ? this.getMarkPos : getPos\n    this.captureEvents = true\n    this.dom = this.createDOM()\n    this.contentDOM = this.vm.$refs.content\n  }\n\n  createDOM() {\n    const Component = Vue.extend(this.component)\n    const props = {\n      editor: this.editor,\n      node: this.node,\n      view: this.view,\n      getPos: () => this.getPos(),\n      decorations: this.decorations,\n      selected: false,\n      options: this.extension.options,\n      updateAttrs: attrs => this.updateAttrs(attrs),\n    }\n\n    if (typeof this.extension.setSelection === 'function') {\n      this.setSelection = this.extension.setSelection\n    }\n\n    if (typeof this.extension.update === 'function') {\n      this.update = this.extension.update\n    }\n\n    this.vm = new Component({\n      parent: this.parent,\n      propsData: props,\n    }).$mount()\n\n    return this.vm.$el\n  }\n\n  update(node, decorations) {\n    if (node.type !== this.node.type) {\n      return false\n    }\n\n    if (node === this.node && this.decorations === decorations) {\n      return true\n    }\n\n    this.node = node\n    this.decorations = decorations\n\n    this.updateComponentProps({\n      node,\n      decorations,\n    })\n\n    return true\n  }\n\n  updateComponentProps(props) {\n    if (!this.vm._props) {\n      return\n    }\n\n    // Update props in component\n    // TODO: Avoid mutating a prop directly.\n    // Maybe there is a better way to do this?\n    const originalSilent = Vue.config.silent\n    Vue.config.silent = true\n\n    Object.entries(props).forEach(([key, value]) => {\n      this.vm._props[key] = value\n    })\n    // this.vm._props.node = node\n    // this.vm._props.decorations = decorations\n    Vue.config.silent = originalSilent\n  }\n\n  updateAttrs(attrs) {\n    if (!this.view.editable) {\n      return\n    }\n\n    const { state } = this.view\n    const { type } = this.node\n    const pos = this.getPos()\n    const newAttrs = {\n      ...this.node.attrs,\n      ...attrs,\n    }\n    const transaction = this.isMark\n      ? state.tr\n        .removeMark(pos.from, pos.to, type)\n        .addMark(pos.from, pos.to, type.create(newAttrs))\n      : state.tr.setNodeMarkup(pos, null, newAttrs)\n\n    this.view.dispatch(transaction)\n  }\n\n  // prevent a full re-render of the vue component on update\n  // we'll handle prop updates in `update()`\n  ignoreMutation(mutation) {\n    // allow leaf nodes to be selected\n    if (mutation.type === 'selection') {\n      return false\n    }\n\n    if (!this.contentDOM) {\n      return true\n    }\n    return !this.contentDOM.contains(mutation.target)\n  }\n\n  // disable (almost) all prosemirror event listener for node views\n  stopEvent(event) {\n    if (typeof this.extension.stopEvent === 'function') {\n      return this.extension.stopEvent(event)\n    }\n\n    const draggable = !!this.extension.schema.draggable\n\n    // support a custom drag handle\n    if (draggable && event.type === 'mousedown') {\n      const dragHandle = event.target.closest\n        && event.target.closest('[data-drag-handle]')\n      const isValidDragHandle = dragHandle\n        && (this.dom === dragHandle || this.dom.contains(dragHandle))\n\n      if (isValidDragHandle) {\n        this.captureEvents = false\n        document.addEventListener('dragend', () => {\n          this.captureEvents = true\n        }, { once: true })\n      }\n    }\n\n    const isCopy = event.type === 'copy'\n    const isPaste = event.type === 'paste'\n    const isCut = event.type === 'cut'\n    const isDrag = event.type.startsWith('drag') || event.type === 'drop'\n\n    if ((draggable && isDrag) || isCopy || isPaste || isCut) {\n      return false\n    }\n\n    return this.captureEvents\n  }\n\n  selectNode() {\n    this.updateComponentProps({\n      selected: true,\n    })\n  }\n\n  deselectNode() {\n    this.updateComponentProps({\n      selected: false,\n    })\n  }\n\n  getMarkPos() {\n    const pos = this.view.posAtDOM(this.dom)\n    const resolvedPos = this.view.state.doc.resolve(pos)\n    const range = getMarkRange(resolvedPos, this.node.type)\n    return range\n  }\n\n  destroy() {\n    this.vm.$destroy()\n  }\n\n}\n"]}]}