{"remainingRequest":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/babel-loader/lib/index.js!/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/eslint-loader/index.js??ref--13-0!/Users/justinwu/Desktop/Gitlab_MyTale/mytale/src/js/tiptap/packages/tiptap/src/Utils/ComponentView.js","dependencies":[{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/src/js/tiptap/packages/tiptap/src/Utils/ComponentView.js","mtime":1604692362851},{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZW50cmllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9HaXRsYWJfTXlUYWxlL215dGFsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9HaXRsYWJfTXlUYWxlL215dGFsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL2p1c3Rpbnd1L0Rlc2t0b3AvR2l0bGFiX015VGFsZS9teXRhbGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9HaXRsYWJfTXlUYWxlL215dGFsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCB7IGdldE1hcmtSYW5nZSB9IGZyb20gJ3RpcHRhcC11dGlscyc7Cgp2YXIgQ29tcG9uZW50VmlldyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQ29tcG9uZW50Vmlldyhjb21wb25lbnQsIF9yZWYpIHsKICAgIHZhciBlZGl0b3IgPSBfcmVmLmVkaXRvciwKICAgICAgICBleHRlbnNpb24gPSBfcmVmLmV4dGVuc2lvbiwKICAgICAgICBwYXJlbnQgPSBfcmVmLnBhcmVudCwKICAgICAgICBub2RlID0gX3JlZi5ub2RlLAogICAgICAgIHZpZXcgPSBfcmVmLnZpZXcsCiAgICAgICAgZGVjb3JhdGlvbnMgPSBfcmVmLmRlY29yYXRpb25zLAogICAgICAgIGdldFBvcyA9IF9yZWYuZ2V0UG9zOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21wb25lbnRWaWV3KTsKCiAgICB0aGlzLmNvbXBvbmVudCA9IGNvbXBvbmVudDsKICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yOwogICAgdGhpcy5leHRlbnNpb24gPSBleHRlbnNpb247CiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDsKICAgIHRoaXMubm9kZSA9IG5vZGU7CiAgICB0aGlzLnZpZXcgPSB2aWV3OwogICAgdGhpcy5kZWNvcmF0aW9ucyA9IGRlY29yYXRpb25zOwogICAgdGhpcy5pc05vZGUgPSAhIXRoaXMubm9kZS5tYXJrczsKICAgIHRoaXMuaXNNYXJrID0gIXRoaXMuaXNOb2RlOwogICAgdGhpcy5nZXRQb3MgPSB0aGlzLmlzTWFyayA/IHRoaXMuZ2V0TWFya1BvcyA6IGdldFBvczsKICAgIHRoaXMuY2FwdHVyZUV2ZW50cyA9IHRydWU7CiAgICB0aGlzLmRvbSA9IHRoaXMuY3JlYXRlRE9NKCk7CiAgICB0aGlzLmNvbnRlbnRET00gPSB0aGlzLnZtLiRyZWZzLmNvbnRlbnQ7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQ29tcG9uZW50VmlldywgW3sKICAgIGtleTogImNyZWF0ZURPTSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlRE9NKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIENvbXBvbmVudCA9IFZ1ZS5leHRlbmQodGhpcy5jb21wb25lbnQpOwogICAgICB2YXIgcHJvcHMgPSB7CiAgICAgICAgZWRpdG9yOiB0aGlzLmVkaXRvciwKICAgICAgICBub2RlOiB0aGlzLm5vZGUsCiAgICAgICAgdmlldzogdGhpcy52aWV3LAogICAgICAgIGdldFBvczogZnVuY3Rpb24gZ2V0UG9zKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmdldFBvcygpOwogICAgICAgIH0sCiAgICAgICAgZGVjb3JhdGlvbnM6IHRoaXMuZGVjb3JhdGlvbnMsCiAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlLAogICAgICAgIG9wdGlvbnM6IHRoaXMuZXh0ZW5zaW9uLm9wdGlvbnMsCiAgICAgICAgdXBkYXRlQXR0cnM6IGZ1bmN0aW9uIHVwZGF0ZUF0dHJzKGF0dHJzKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlQXR0cnMoYXR0cnMpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmICh0eXBlb2YgdGhpcy5leHRlbnNpb24uc2V0U2VsZWN0aW9uID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24gPSB0aGlzLmV4dGVuc2lvbi5zZXRTZWxlY3Rpb247CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgdGhpcy5leHRlbnNpb24udXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdGhpcy51cGRhdGUgPSB0aGlzLmV4dGVuc2lvbi51cGRhdGU7CiAgICAgIH0KCiAgICAgIHRoaXMudm0gPSBuZXcgQ29tcG9uZW50KHsKICAgICAgICBwYXJlbnQ6IHRoaXMucGFyZW50LAogICAgICAgIHByb3BzRGF0YTogcHJvcHMKICAgICAgfSkuJG1vdW50KCk7CiAgICAgIHJldHVybiB0aGlzLnZtLiRlbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZShub2RlLCBkZWNvcmF0aW9ucykgewogICAgICBpZiAobm9kZS50eXBlICE9PSB0aGlzLm5vZGUudHlwZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKG5vZGUgPT09IHRoaXMubm9kZSAmJiB0aGlzLmRlY29yYXRpb25zID09PSBkZWNvcmF0aW9ucykgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICB0aGlzLm5vZGUgPSBub2RlOwogICAgICB0aGlzLmRlY29yYXRpb25zID0gZGVjb3JhdGlvbnM7CiAgICAgIHRoaXMudXBkYXRlQ29tcG9uZW50UHJvcHMoewogICAgICAgIG5vZGU6IG5vZGUsCiAgICAgICAgZGVjb3JhdGlvbnM6IGRlY29yYXRpb25zCiAgICAgIH0pOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVDb21wb25lbnRQcm9wcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQ29tcG9uZW50UHJvcHMocHJvcHMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMudm0uX3Byb3BzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFVwZGF0ZSBwcm9wcyBpbiBjb21wb25lbnQKICAgICAgLy8gVE9ETzogQXZvaWQgbXV0YXRpbmcgYSBwcm9wIGRpcmVjdGx5LgogICAgICAvLyBNYXliZSB0aGVyZSBpcyBhIGJldHRlciB3YXkgdG8gZG8gdGhpcz8KCgogICAgICB2YXIgb3JpZ2luYWxTaWxlbnQgPSBWdWUuY29uZmlnLnNpbGVudDsKICAgICAgVnVlLmNvbmZpZy5zaWxlbnQgPSB0cnVlOwogICAgICBPYmplY3QuZW50cmllcyhwcm9wcykuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICB2YXIgX3JlZjMgPSBfc2xpY2VkVG9BcnJheShfcmVmMiwgMiksCiAgICAgICAgICAgIGtleSA9IF9yZWYzWzBdLAogICAgICAgICAgICB2YWx1ZSA9IF9yZWYzWzFdOwoKICAgICAgICBfdGhpczIudm0uX3Byb3BzW2tleV0gPSB2YWx1ZTsKICAgICAgfSk7IC8vIHRoaXMudm0uX3Byb3BzLm5vZGUgPSBub2RlCiAgICAgIC8vIHRoaXMudm0uX3Byb3BzLmRlY29yYXRpb25zID0gZGVjb3JhdGlvbnMKCiAgICAgIFZ1ZS5jb25maWcuc2lsZW50ID0gb3JpZ2luYWxTaWxlbnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlQXR0cnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHJzKGF0dHJzKSB7CiAgICAgIGlmICghdGhpcy52aWV3LmVkaXRhYmxlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgc3RhdGUgPSB0aGlzLnZpZXcuc3RhdGU7CiAgICAgIHZhciB0eXBlID0gdGhpcy5ub2RlLnR5cGU7CiAgICAgIHZhciBwb3MgPSB0aGlzLmdldFBvcygpOwoKICAgICAgdmFyIG5ld0F0dHJzID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLm5vZGUuYXR0cnMpLCBhdHRycyk7CgogICAgICB2YXIgdHJhbnNhY3Rpb24gPSB0aGlzLmlzTWFyayA/IHN0YXRlLnRyLnJlbW92ZU1hcmsocG9zLmZyb20sIHBvcy50bywgdHlwZSkuYWRkTWFyayhwb3MuZnJvbSwgcG9zLnRvLCB0eXBlLmNyZWF0ZShuZXdBdHRycykpIDogc3RhdGUudHIuc2V0Tm9kZU1hcmt1cChwb3MsIG51bGwsIG5ld0F0dHJzKTsKICAgICAgdGhpcy52aWV3LmRpc3BhdGNoKHRyYW5zYWN0aW9uKTsKICAgIH0gLy8gcHJldmVudCBhIGZ1bGwgcmUtcmVuZGVyIG9mIHRoZSB2dWUgY29tcG9uZW50IG9uIHVwZGF0ZQogICAgLy8gd2UnbGwgaGFuZGxlIHByb3AgdXBkYXRlcyBpbiBgdXBkYXRlKClgCgogIH0sIHsKICAgIGtleTogImlnbm9yZU11dGF0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpZ25vcmVNdXRhdGlvbihtdXRhdGlvbikgewogICAgICAvLyBhbGxvdyBsZWFmIG5vZGVzIHRvIGJlIHNlbGVjdGVkCiAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnc2VsZWN0aW9uJykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmNvbnRlbnRET00pIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuICF0aGlzLmNvbnRlbnRET00uY29udGFpbnMobXV0YXRpb24udGFyZ2V0KTsKICAgIH0gLy8gZGlzYWJsZSAoYWxtb3N0KSBhbGwgcHJvc2VtaXJyb3IgZXZlbnQgbGlzdGVuZXIgZm9yIG5vZGUgdmlld3MKCiAgfSwgewogICAga2V5OiAic3RvcEV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wRXZlbnQoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAodHlwZW9mIHRoaXMuZXh0ZW5zaW9uLnN0b3BFdmVudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiB0aGlzLmV4dGVuc2lvbi5zdG9wRXZlbnQoZXZlbnQpOwogICAgICB9CgogICAgICB2YXIgZHJhZ2dhYmxlID0gISF0aGlzLmV4dGVuc2lvbi5zY2hlbWEuZHJhZ2dhYmxlOyAvLyBzdXBwb3J0IGEgY3VzdG9tIGRyYWcgaGFuZGxlCgogICAgICBpZiAoZHJhZ2dhYmxlICYmIGV2ZW50LnR5cGUgPT09ICdtb3VzZWRvd24nKSB7CiAgICAgICAgdmFyIGRyYWdIYW5kbGUgPSBldmVudC50YXJnZXQuY2xvc2VzdCAmJiBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtZHJhZy1oYW5kbGVdJyk7CiAgICAgICAgdmFyIGlzVmFsaWREcmFnSGFuZGxlID0gZHJhZ0hhbmRsZSAmJiAodGhpcy5kb20gPT09IGRyYWdIYW5kbGUgfHwgdGhpcy5kb20uY29udGFpbnMoZHJhZ0hhbmRsZSkpOwoKICAgICAgICBpZiAoaXNWYWxpZERyYWdIYW5kbGUpIHsKICAgICAgICAgIHRoaXMuY2FwdHVyZUV2ZW50cyA9IGZhbHNlOwogICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMzLmNhcHR1cmVFdmVudHMgPSB0cnVlOwogICAgICAgICAgfSwgewogICAgICAgICAgICBvbmNlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBpc0NvcHkgPSBldmVudC50eXBlID09PSAnY29weSc7CiAgICAgIHZhciBpc1Bhc3RlID0gZXZlbnQudHlwZSA9PT0gJ3Bhc3RlJzsKICAgICAgdmFyIGlzQ3V0ID0gZXZlbnQudHlwZSA9PT0gJ2N1dCc7CiAgICAgIHZhciBpc0RyYWcgPSBldmVudC50eXBlLnN0YXJ0c1dpdGgoJ2RyYWcnKSB8fCBldmVudC50eXBlID09PSAnZHJvcCc7CgogICAgICBpZiAoZHJhZ2dhYmxlICYmIGlzRHJhZyB8fCBpc0NvcHkgfHwgaXNQYXN0ZSB8fCBpc0N1dCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuY2FwdHVyZUV2ZW50czsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZWxlY3ROb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3ROb2RlKCkgewogICAgICB0aGlzLnVwZGF0ZUNvbXBvbmVudFByb3BzKHsKICAgICAgICBzZWxlY3RlZDogdHJ1ZQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXNlbGVjdE5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc2VsZWN0Tm9kZSgpIHsKICAgICAgdGhpcy51cGRhdGVDb21wb25lbnRQcm9wcyh7CiAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldE1hcmtQb3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1hcmtQb3MoKSB7CiAgICAgIHZhciBwb3MgPSB0aGlzLnZpZXcucG9zQXRET00odGhpcy5kb20pOwogICAgICB2YXIgcmVzb2x2ZWRQb3MgPSB0aGlzLnZpZXcuc3RhdGUuZG9jLnJlc29sdmUocG9zKTsKICAgICAgdmFyIHJhbmdlID0gZ2V0TWFya1JhbmdlKHJlc29sdmVkUG9zLCB0aGlzLm5vZGUudHlwZSk7CiAgICAgIHJldHVybiByYW5nZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICB0aGlzLnZtLiRkZXN0cm95KCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQ29tcG9uZW50VmlldzsKfSgpOwoKZXhwb3J0IHsgQ29tcG9uZW50VmlldyBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["/Users/justinwu/Desktop/Gitlab_MyTale/mytale/src/js/tiptap/packages/tiptap/src/Utils/ComponentView.js"],"names":["Vue","getMarkRange","ComponentView","component","editor","extension","parent","node","view","decorations","getPos","isNode","marks","isMark","getMarkPos","captureEvents","dom","createDOM","contentDOM","vm","$refs","content","Component","extend","props","selected","options","updateAttrs","attrs","setSelection","update","propsData","$mount","$el","type","updateComponentProps","_props","originalSilent","config","silent","Object","entries","forEach","key","value","editable","state","pos","newAttrs","transaction","tr","removeMark","from","to","addMark","create","setNodeMarkup","dispatch","mutation","contains","target","event","stopEvent","draggable","schema","dragHandle","closest","isValidDragHandle","document","addEventListener","once","isCopy","isPaste","isCut","isDrag","startsWith","posAtDOM","resolvedPos","doc","resolve","range","$destroy"],"mappings":"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","sourcesContent":["import Vue from 'vue'\n\nimport { getMarkRange } from 'tiptap-utils'\n\nexport default class ComponentView {\n\n  constructor(component, {\n    editor,\n    extension,\n    parent,\n    node,\n    view,\n    decorations,\n    getPos,\n  }) {\n    this.component = component\n    this.editor = editor\n    this.extension = extension\n    this.parent = parent\n    this.node = node\n    this.view = view\n    this.decorations = decorations\n    this.isNode = !!this.node.marks\n    this.isMark = !this.isNode\n    this.getPos = this.isMark ? this.getMarkPos : getPos\n    this.captureEvents = true\n    this.dom = this.createDOM()\n    this.contentDOM = this.vm.$refs.content\n  }\n\n  createDOM() {\n    const Component = Vue.extend(this.component)\n    const props = {\n      editor: this.editor,\n      node: this.node,\n      view: this.view,\n      getPos: () => this.getPos(),\n      decorations: this.decorations,\n      selected: false,\n      options: this.extension.options,\n      updateAttrs: attrs => this.updateAttrs(attrs),\n    }\n\n    if (typeof this.extension.setSelection === 'function') {\n      this.setSelection = this.extension.setSelection\n    }\n\n    if (typeof this.extension.update === 'function') {\n      this.update = this.extension.update\n    }\n\n    this.vm = new Component({\n      parent: this.parent,\n      propsData: props,\n    }).$mount()\n\n    return this.vm.$el\n  }\n\n  update(node, decorations) {\n    if (node.type !== this.node.type) {\n      return false\n    }\n\n    if (node === this.node && this.decorations === decorations) {\n      return true\n    }\n\n    this.node = node\n    this.decorations = decorations\n\n    this.updateComponentProps({\n      node,\n      decorations,\n    })\n\n    return true\n  }\n\n  updateComponentProps(props) {\n    if (!this.vm._props) {\n      return\n    }\n\n    // Update props in component\n    // TODO: Avoid mutating a prop directly.\n    // Maybe there is a better way to do this?\n    const originalSilent = Vue.config.silent\n    Vue.config.silent = true\n\n    Object.entries(props).forEach(([key, value]) => {\n      this.vm._props[key] = value\n    })\n    // this.vm._props.node = node\n    // this.vm._props.decorations = decorations\n    Vue.config.silent = originalSilent\n  }\n\n  updateAttrs(attrs) {\n    if (!this.view.editable) {\n      return\n    }\n\n    const { state } = this.view\n    const { type } = this.node\n    const pos = this.getPos()\n    const newAttrs = {\n      ...this.node.attrs,\n      ...attrs,\n    }\n    const transaction = this.isMark\n      ? state.tr\n        .removeMark(pos.from, pos.to, type)\n        .addMark(pos.from, pos.to, type.create(newAttrs))\n      : state.tr.setNodeMarkup(pos, null, newAttrs)\n\n    this.view.dispatch(transaction)\n  }\n\n  // prevent a full re-render of the vue component on update\n  // we'll handle prop updates in `update()`\n  ignoreMutation(mutation) {\n    // allow leaf nodes to be selected\n    if (mutation.type === 'selection') {\n      return false\n    }\n\n    if (!this.contentDOM) {\n      return true\n    }\n    return !this.contentDOM.contains(mutation.target)\n  }\n\n  // disable (almost) all prosemirror event listener for node views\n  stopEvent(event) {\n    if (typeof this.extension.stopEvent === 'function') {\n      return this.extension.stopEvent(event)\n    }\n\n    const draggable = !!this.extension.schema.draggable\n\n    // support a custom drag handle\n    if (draggable && event.type === 'mousedown') {\n      const dragHandle = event.target.closest\n        && event.target.closest('[data-drag-handle]')\n      const isValidDragHandle = dragHandle\n        && (this.dom === dragHandle || this.dom.contains(dragHandle))\n\n      if (isValidDragHandle) {\n        this.captureEvents = false\n        document.addEventListener('dragend', () => {\n          this.captureEvents = true\n        }, { once: true })\n      }\n    }\n\n    const isCopy = event.type === 'copy'\n    const isPaste = event.type === 'paste'\n    const isCut = event.type === 'cut'\n    const isDrag = event.type.startsWith('drag') || event.type === 'drop'\n\n    if ((draggable && isDrag) || isCopy || isPaste || isCut) {\n      return false\n    }\n\n    return this.captureEvents\n  }\n\n  selectNode() {\n    this.updateComponentProps({\n      selected: true,\n    })\n  }\n\n  deselectNode() {\n    this.updateComponentProps({\n      selected: false,\n    })\n  }\n\n  getMarkPos() {\n    const pos = this.view.posAtDOM(this.dom)\n    const resolvedPos = this.view.state.doc.resolve(pos)\n    const range = getMarkRange(resolvedPos, this.node.type)\n    return range\n  }\n\n  destroy() {\n    this.vm.$destroy()\n  }\n\n}\n"]}]}