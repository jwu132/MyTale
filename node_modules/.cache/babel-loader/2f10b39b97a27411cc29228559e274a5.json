{"remainingRequest":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/babel-loader/lib/index.js!/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/eslint-loader/index.js??ref--13-0!/Users/justinwu/Desktop/Gitlab_MyTale/mytale/src/js/extwee_utils/HTMLWriter.js","dependencies":[{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/src/js/extwee_utils/HTMLWriter.js","mtime":1604692362842},{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/justinwu/Desktop/Gitlab_MyTale/mytale/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIik7Cgp2YXIgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIgPSByZXF1aXJlKCIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9HaXRsYWJfTXlUYWxlL215dGFsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrID0gcmVxdWlyZSgiL1VzZXJzL2p1c3Rpbnd1L0Rlc2t0b3AvR2l0bGFiX015VGFsZS9teXRhbGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siKTsKCnZhciBfY3JlYXRlQ2xhc3MgPSByZXF1aXJlKCIvVXNlcnMvanVzdGlud3UvRGVza3RvcC9HaXRsYWJfTXlUYWxlL215dGFsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpOwoKLyoqCiAqIEBleHRlcm5hbCBTdG9yeQogKiBAc2VlIFN0b3J5LmpzCiAqIEBleHRlcm5hbCBTdG9yeUZvcm1hdAogKiBAc2VlIFN0b3J5Rm9ybWF0LmpzCiAqLwp2YXIgU3RvcnkgPSByZXF1aXJlKCcuL1N0b3J5LmpzJyk7Cgp2YXIgU3RvcnlGb3JtYXQgPSByZXF1aXJlKCcuL1N0b3J5Rm9ybWF0LmpzJyk7Ci8qKgogKiBAY2xhc3MgSFRNTFdyaXRlcgogKiBAbW9kdWxlIEhUTUxXcml0ZXIKICovCgoKdmFyIEhUTUxXcml0ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICJ1c2Ugc3RyaWN0IjsKCiAgLyoqCiAgICogQGZ1bmN0aW9uIEhUTUxXcml0ZXIKICAgKiBAY2xhc3MKICAgKiBAcGFyYW0ge1N0b3J5fSBzdG9yeSAtIFN0b3J5IG9iamVjdCB0byB3cml0ZQogICAqIEBwYXJhbSB7U3RvcnlGb3JtYXR9IHN0b3J5Rm9ybWF0IC0gU3RvcnkgZm9ybWF0IHRvIHdyaXRlCiAgICogQHBhcmFtIHtzdHJpbmd9IGNzcyAtIEFueSBDU1MgdG8gd3JpdGUKICAgKiBAcGFyYW0ge3N0cmluZ30ganMgLSBBbnkgSlMgdG8gd3JpdGUKICAgKi8KICBmdW5jdGlvbiBIVE1MV3JpdGVyKHN0b3J5LCBzdG9yeUZvcm1hdCwgY3NzLCBqcykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEhUTUxXcml0ZXIpOwoKICAgIGlmICghKHN0b3J5IGluc3RhbmNlb2YgU3RvcnkpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignRXJyb3I6IHN0b3J5IG11c3QgYmUgYSBTdG9yeSBvYmplY3QhJyk7CiAgICB9CgogICAgaWYgKCEoc3RvcnlGb3JtYXQgaW5zdGFuY2VvZiBTdG9yeUZvcm1hdCkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdG9yeUZvcm1hdCBtdXN0IGJlIGEgU3RvcnlGb3JtYXQgb2JqZWN0IScpOwogICAgfQoKICAgIHRoaXMub3V0cHV0ID0gIiI7CiAgICB2YXIgY3NzQ29udGVudCA9IGNzcyB8fCBudWxsOwogICAgdmFyIGpzQ29udGVudCA9IGpzIHx8IG51bGw7CiAgICB0aGlzLndyaXRlRmlsZShzdG9yeSwgc3RvcnlGb3JtYXQsIGNzc0NvbnRlbnQsIGpzQ29udGVudCk7CiAgfQogIC8qKgogICAqIFdyaXRlIHN0b3J5IHRvIGZpbGUgdXNpbmcgc3RvcnkgZm9ybWF0IGFuZCBhZGRpbmcgYW55IENTUyBhbmQgSlMKICAgKgogICAqIEBmdW5jdGlvbiB3cml0ZUZpbGUKICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsZSAtIEZpbGUgdG8gd3JpdGUKICAgKiBAcGFyYW0ge1N0b3J5fSBzdG9yeSAtIFN0b3J5IG9iamVjdCB0byB3cml0ZQogICAqIEBwYXJhbSB7U3RvcnlGb3JtYXR9IHN0b3J5Rm9ybWF0IC0gU3RvcnlGb3JtYXQgdG8gd3JpdGUKICAgKiBAcGFyYW0ge3N0cmluZ30gY3NzQ29udGVudCAtIEFueSBDU1MgdG8gd3JpdGUKICAgKiBAcGFyYW0ge3N0cmluZ30ganNDb250ZW50IC0gQW55IEpTIHRvIHdyaXRlCiAgICogQHJldHVybnMge3ZvaWR9CiAgICovCgoKICBfY3JlYXRlQ2xhc3MoSFRNTFdyaXRlciwgW3sKICAgIGtleTogIndyaXRlRmlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gd3JpdGVGaWxlKHN0b3J5LCBzdG9yeUZvcm1hdCwgY3NzQ29udGVudCwganNDb250ZW50KSB7CiAgICAgIHZhciBvdXRwdXRDb250ZW50cyA9ICcnOwogICAgICB0aGlzLm91dHB1dCA9ICIiOyAvLyBCdWlsZCA8dHctc3RvcnlkYXRhPgoKICAgICAgdmFyIHN0b3J5RGF0YSA9ICc8dHctc3RvcnlkYXRhIG5hbWU9IicgKyBzdG9yeS5uYW1lICsgJyIgJyArICdzdGFydG5vZGU9IicgKyBzdG9yeS5nZXRTdGFydGluZ1Bhc3NhZ2UoKSArICciICcgKyAnY3JlYXRvcj0iJyArIHN0b3J5LmNyZWF0b3IgKyAnIiAnICsgJ2NyZWF0b3ItdmVyc2lvbj0iJyArIHN0b3J5LmNyZWF0b3JWZXJzaW9uICsgJyIgJyArICdpZmlkPSInICsgc3RvcnkubWV0YWRhdGEuaWZpZCArICciICcgKyAnem9vbT0iJyArIHN0b3J5Lm1ldGFkYXRhLnpvb20gKyAnIiAnICsgJ2Zvcm1hdD0iJyArIHN0b3J5Rm9ybWF0Lm5hbWUgKyAnIiAnICsgJ2Zvcm1hdC12ZXJzaW9uPSInICsgc3RvcnlGb3JtYXQudmVyc2lvbiArICciICcgKyAnb3B0aW9ucyBoaWRkZW4+XG4nOyAvLyBCdWlsZCB0aGUgU1RZTEUKCiAgICAgIHN0b3J5RGF0YSArPSAnPHN0eWxlIHJvbGU9InN0eWxlc2hlZXQiIGlkPSJ0d2luZS11c2VyLXN0eWxlc2hlZXQiIHR5cGU9InRleHQvdHdpbmUtY3NzIj4nOyAvLyBHZXQgYW55IHBhc3NhZ2VzIHRhZ2dlZCB3aXRoICdzdHlsZXNoZWV0JwoKICAgICAgdmFyIHN0eWxlUGFzc2FnZXMgPSBzdG9yeS5nZXRTdHlsZVBhc3NhZ2VzKCk7IC8vIENTUyBwYXNzZWQgdGhyb3VnaCBmcm9tIERpcmVjdG9yeVJlYWRlcgoKICAgICAgaWYgKGNzc0NvbnRlbnQgIT0gbnVsbCkgewogICAgICAgIHN0b3J5RGF0YSArPSBjc3NDb250ZW50OwogICAgICB9IC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgY29sbGVjdGlvbiBhbmQgYWRkIHRvIHN0b3J5RGF0YQoKCiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihzdHlsZVBhc3NhZ2VzKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGNvbnRlbnQgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgIHN0b3J5RGF0YSArPSBjb250ZW50LnRleHQ7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgIH0KCiAgICAgIHN0b3J5RGF0YSArPSAnPC9zdHlsZT5cbic7IC8vIEJ1aWxkIHRoZSBTQ1JJUFQKCiAgICAgIHN0b3J5RGF0YSArPSAnPHNjcmlwdCByb2xlPSJzY3JpcHQiIGlkPSJ0d2luZS11c2VyLXNjcmlwdCIgdHlwZT0idGV4dC90d2luZS1qYXZhc2NyaXB0Ij4nOyAvLyBHZXQgYW55IHBhc3NhZ2VzIHRhZ2dlZCB3aXRoICdzY3JpcHQnCgogICAgICB2YXIgc2NyaXB0UGFzc2FnZXMgPSBzdG9yeS5nZXRTY3JpcHRQYXNzYWdlcygpOyAvLyBKUyBwYXNzZWQgdGhyb3VnaCBmcm9tIERpcmVjdG9yeVJlYWRlcgoKICAgICAgaWYgKGpzQ29udGVudCAhPSBudWxsKSB7CiAgICAgICAgc3RvcnlEYXRhICs9IGpzQ29udGVudDsKICAgICAgfSAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIGNvbGxlY3Rpb24gYW5kIGFkZCB0byBzdG9yeURhdGEKCgogICAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHNjcmlwdFBhc3NhZ2VzKSwKICAgICAgICAgIF9zdGVwMjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBfY29udGVudCA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgIHN0b3J5RGF0YSArPSBfY29udGVudC50ZXh0OwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgIH0KCiAgICAgIHN0b3J5RGF0YSArPSAnPC9zY3JpcHQ+XG4nOyAvLyBBbGwgdGhlIHNjcmlwdCBkYXRhIGhhcyBiZWVuIHdyaXR0ZW4uCiAgICAgIC8vIERlbGV0ZSBhbGwgJ3NjcmlwdCctdGFnZ2VkIHBhc3NhZ2VzCiAgICAgIC8vc3RvcnkuZGVsZXRlQWxsQnlUYWcoJ3NjcmlwdCcpOwogICAgICAvLyBBbGwgdGhlIHN0eWxlIGRhdGEgaGFzIGJlZW4gd3JpdHRlbi4KICAgICAgLy8gRGVsZXRlIGFsbCAnc3R5bGUnLXRhZ2dlZCBwYXNzYWdlcwogICAgICAvL3N0b3J5LmRlbGV0ZUFsbEJ5VGFnKCdzdHlsZXNoZWV0Jyk7CiAgICAgIC8vIEJ1aWxkIHRoZSBwYXNzYWdlcwoKICAgICAgdmFyIF9pdGVyYXRvcjMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihzdG9yeS5nZXRTdG9yeVBhc3NhZ2VzKCkpLAogICAgICAgICAgX3N0ZXAzOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgdmFyIHBhc3NhZ2UgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICBzdG9yeURhdGEgKz0gJzx0dy1wYXNzYWdlZGF0YSBwaWQ9IicgKyBwYXNzYWdlLnBpZCArICciIG5hbWU9IicgKyBwYXNzYWdlLm5hbWUgKyAnIic7IC8vIFdyaXRlIG91dCBhbnkgdGFncwoKICAgICAgICAgIGlmIChwYXNzYWdlLnRhZ3MubGVuZ3RoID4gMSkgewogICAgICAgICAgICBzdG9yeURhdGEgKz0gJyB0YWdzPSInOwoKICAgICAgICAgICAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihwYXNzYWdlLnRhZ3MpLAogICAgICAgICAgICAgICAgX3N0ZXA0OwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgdmFyIHQgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICAgICAgICBzdG9yeURhdGEgKz0gdCArICcgJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIF9pdGVyYXRvcjQuZShlcnIpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIF9pdGVyYXRvcjQuZigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzdG9yeURhdGEgKz0gJyIgJzsKICAgICAgICAgIH0gZWxzZSBpZiAocGFzc2FnZS50YWdzLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgICBzdG9yeURhdGEgKz0gJyB0YWdzPSInICsgcGFzc2FnZS50YWdzWzBdICsgJyIgJzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0b3J5RGF0YSArPSAnIHRhZ3MgJzsKICAgICAgICAgIH0gLy8gV3JpdGUgb3V0IHBvc2l0aW9uCgoKICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocGFzc2FnZS5tZXRhZGF0YSwgJ3Bvc2l0aW9uJykpIHsKICAgICAgICAgICAgc3RvcnlEYXRhICs9ICdwb3NpdGlvbj0iJyArIHBhc3NhZ2UubWV0YWRhdGEucG9zaXRpb24gKyAnIiAnOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRGlkbid0IGhhdmUgYSBwb3NpdGlvbi4KICAgICAgICAgICAgLy8gTWFrZSBvbmUgdXAuCiAgICAgICAgICAgIHN0b3J5RGF0YSArPSAncG9zaXRpb249IjEwMCwxMDAiICc7CiAgICAgICAgICB9IC8vIFdyaXRlIG91dCBzaXplCgoKICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocGFzc2FnZS5tZXRhZGF0YSwgJ3NpemUnKSkgewogICAgICAgICAgICBzdG9yeURhdGEgKz0gJ3NpemU9IicgKyBwYXNzYWdlLm1ldGFkYXRhLnNpemUgKyAnIiAnOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRGlkbid0IGhhdmUgYSBzaXplLgogICAgICAgICAgICAvLyBNYWtlIG9uZSB1cC4KICAgICAgICAgICAgc3RvcnlEYXRhICs9ICdzaXplPSIxMDAsMTAwIiAnOwogICAgICAgICAgfQoKICAgICAgICAgIHN0b3J5RGF0YSArPSAnPicgKyBwYXNzYWdlLnRleHQgKyAnPC90dy1wYXNzYWdlZGF0YT5cbic7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IzLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IzLmYoKTsKICAgICAgfQoKICAgICAgc3RvcnlEYXRhICs9ICc8L3R3LXN0b3J5ZGF0YT4nOyAvLyBSZXBsYWNlIHRoZSBzdG9yeSBuYW1lIGluIHRoZSBzb3VyY2UgZmlsZQoKICAgICAgdmFyIHNvdXJjZSA9IHN0b3J5Rm9ybWF0LnNvdXJjZS5yZXBsYWNlKCd7e1NUT1JZX05BTUV9fScsIHN0b3J5Lm5hbWUpOyAvLyBSZXBsYWNlIHRoZSBzdG9yeSBkYXRhCgogICAgICBzb3VyY2UgPSBzb3VyY2UucmVwbGFjZSgne3tTVE9SWV9EQVRBfX0nLCBzdG9yeURhdGEpOwogICAgICBvdXRwdXRDb250ZW50cyArPSBzb3VyY2U7CiAgICAgIHRoaXMub3V0cHV0ID0gb3V0cHV0Q29udGVudHM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSFRNTFdyaXRlcjsKfSgpOwoKbW9kdWxlLmV4cG9ydHMgPSBIVE1MV3JpdGVyOw=="},{"version":3,"sources":["/Users/justinwu/Desktop/Gitlab_MyTale/mytale/src/js/extwee_utils/HTMLWriter.js"],"names":["Story","require","StoryFormat","HTMLWriter","story","storyFormat","css","js","Error","output","cssContent","jsContent","writeFile","outputContents","storyData","name","getStartingPassage","creator","creatorVersion","metadata","ifid","zoom","version","stylePassages","getStylePassages","content","text","scriptPassages","getScriptPassages","getStoryPassages","passage","pid","tags","length","t","Object","prototype","hasOwnProperty","call","position","size","source","replace","module","exports"],"mappings":"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","sourcesContent":["/**\n * @external Story\n * @see Story.js\n * @external StoryFormat\n * @see StoryFormat.js\n */\n\nconst Story = require('./Story.js');\nconst StoryFormat = require('./StoryFormat.js');\n/**\n * @class HTMLWriter\n * @module HTMLWriter\n */\nclass HTMLWriter {\n  /**\n   * @function HTMLWriter\n   * @class\n   * @param {Story} story - Story object to write\n   * @param {StoryFormat} storyFormat - Story format to write\n   * @param {string} css - Any CSS to write\n   * @param {string} js - Any JS to write\n   */\n  constructor (story, storyFormat, css, js) {\n    if (!(story instanceof Story)) {\n      throw new Error('Error: story must be a Story object!');\n    }\n\n    if (!(storyFormat instanceof StoryFormat)) {\n      throw new Error('storyFormat must be a StoryFormat object!');\n    }\n\n    this.output = \"\";\n\n    const cssContent = css || null;\n    const jsContent = js || null;\n\n    this.writeFile(story, storyFormat, cssContent, jsContent);\n  }\n\n  /**\n   * Write story to file using story format and adding any CSS and JS\n   *\n   * @function writeFile\n   * @param {string} file - File to write\n   * @param {Story} story - Story object to write\n   * @param {StoryFormat} storyFormat - StoryFormat to write\n   * @param {string} cssContent - Any CSS to write\n   * @param {string} jsContent - Any JS to write\n   * @returns {void}\n   */\n  writeFile (story, storyFormat, cssContent, jsContent) {\n    let outputContents = '';\n    this.output = \"\";\n\n    // Build <tw-storydata>\n    let storyData =\n            '<tw-storydata name=\"' + story.name + '\" ' +\n            'startnode=\"' + story.getStartingPassage() + '\" ' +\n            'creator=\"' + story.creator + '\" ' +\n            'creator-version=\"' + story.creatorVersion + '\" ' +\n            'ifid=\"' + story.metadata.ifid + '\" ' +\n            'zoom=\"' + story.metadata.zoom + '\" ' +\n            'format=\"' + storyFormat.name + '\" ' +\n            'format-version=\"' + storyFormat.version + '\" ' +\n            'options hidden>\\n';\n\n    // Build the STYLE\n    storyData += '<style role=\"stylesheet\" id=\"twine-user-stylesheet\" type=\"text/twine-css\">';\n\n    // Get any passages tagged with 'stylesheet'\n    const stylePassages = story.getStylePassages();\n\n    // CSS passed through from DirectoryReader\n    if (cssContent != null) {\n      storyData += cssContent;\n    }\n\n    // Iterate through the collection and add to storyData\n    for (const content of stylePassages) {\n      storyData += content.text;\n    }\n\n    storyData += '</style>\\n';\n\n    // Build the SCRIPT\n    storyData += '<script role=\"script\" id=\"twine-user-script\" type=\"text/twine-javascript\">';\n\n    // Get any passages tagged with 'script'\n    const scriptPassages = story.getScriptPassages();\n\n    // JS passed through from DirectoryReader\n    if (jsContent != null) {\n      storyData += jsContent;\n    }\n\n    // Iterate through the collection and add to storyData\n    for (const content of scriptPassages) {\n      storyData += content.text;\n    }\n\n    storyData += '</script>\\n';\n\n    // All the script data has been written.\n    // Delete all 'script'-tagged passages\n    //story.deleteAllByTag('script');\n\n    // All the style data has been written.\n    // Delete all 'style'-tagged passages\n    //story.deleteAllByTag('stylesheet');\n\n    // Build the passages\n    for (const passage of story.getStoryPassages()) {\n\n      storyData += '<tw-passagedata pid=\"' + passage.pid + '\" name=\"' + passage.name + '\"';\n\n      // Write out any tags\n      if (passage.tags.length > 1) {\n        storyData += ' tags=\"';\n\n        for (const t of passage.tags) {\n          storyData += t + ' ';\n        }\n\n        storyData += '\" ';\n      } else if (passage.tags.length === 1) {\n        storyData += ' tags=\"' + passage.tags[0] + '\" ';\n      } else {\n        storyData += ' tags ';\n      }\n\n      // Write out position\n      if (Object.prototype.hasOwnProperty.call(passage.metadata, 'position')) {\n        storyData += 'position=\"' +\n                    passage.metadata.position + '\" ';\n      } else {\n        // Didn't have a position.\n        // Make one up.\n        storyData += 'position=\"100,100\" ';\n      }\n\n      // Write out size\n      if (Object.prototype.hasOwnProperty.call(passage.metadata, 'size')) {\n        storyData += 'size=\"' +\n                    passage.metadata.size + '\" ';\n      } else {\n        // Didn't have a size.\n        // Make one up.\n        storyData += 'size=\"100,100\" ';\n      }\n\n      storyData += '>' + passage.text + '</tw-passagedata>\\n';\n    }\n\n    storyData += '</tw-storydata>';\n\n    // Replace the story name in the source file\n    var source = storyFormat.source.replace('{{STORY_NAME}}', story.name);\n\n    // Replace the story data\n    source = source.replace('{{STORY_DATA}}', storyData);\n\n    outputContents += source;\n    \n    this.output = outputContents;\n  }\n}\n\nmodule.exports = HTMLWriter;\n"]}]}