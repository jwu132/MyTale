(function(e){function t(t){for(var a,r,o=t[0],l=t[1],c=t[2],u=0,h=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&h.push(n[r][0]),n[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);d&&d(t);while(h.length)h.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==n[l]&&(a=!1)}a&&(s.splice(t--,1),e=r(r.s=i[0]))}return e}var a={},n={editor:0},s=[];function r(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=a,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/MyTale/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=l;s.push([4,"chunk-vendors","chunk-common"]),i()})({"0011":function(e,t,i){"use strict";var a=i("79d3"),n=i.n(a);n.a},"0c59":function(e,t,i){"use strict";var a=i("b52d"),n=i.n(a);n.a},"1cf5":function(e,t,i){var a=i("970b"),n=i("5bc3"),s=i("df22"),r=i("cf78"),o=i("2a30"),l=i("fc8c"),c=i("1bbf"),d=i("bc3a"),u=d.default,h=function(){"use strict";function e(t,i){a(this,e),this.htmlBlob=null,this.tweeBlob=null,this.story=null,this.storyFormat=null,this.contents=t,this.extractStory(i),this.extractStoryFormat()}return n(e,[{key:"extractStory",value:function(e){if(e){var t=new s(this.contents);this.story=t.story}else{var i=new l(this.contents);this.story=i.story}}},{key:"extractStoryFormat",value:function(){var e=this;u.get("/storyformats/harlowe-3/format.js").then((function(t){var i=new c(t.data);e.storyFormat=i.storyformat}))}},{key:"html",value:function(e,t){var i=new o(this.story,this.storyFormat,e,t);return i.output}},{key:"twee",value:function(){var e=new r(this.story);return e.output}},{key:"shtml",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=new o(e,this.storyFormat,t,i);this.htmlBlob=a.output}},{key:"stwee",value:function(e){var t=new r(e);this.tweeBlob=t.output}}]),e}();e.exports=h},"323f":function(e,t,i){"use strict";var a=i("bfca"),n=i.n(a);n.a},3690:function(e,t,i){"use strict";var a=i("7399"),n=i.n(a);n.a},3808:function(e,t,i){},4:function(e,t,i){e.exports=i("a630c")},"443e":function(e,t,i){"use strict";var a=i("e8ba"),n=i.n(a);n.a},4767:function(e,t,i){"use strict";var a=i("6721"),n=i.n(a);n.a},"4b7f":function(e,t,i){},"4f67":function(e,t,i){},"524e":function(e,t,i){"use strict";var a=i("a9f3"),n=i.n(a);n.a},"52a4":function(e,t,i){"use strict";var a=i("6341"),n=i.n(a);n.a},5759:function(e,t,i){"use strict";var a=i("a7db"),n=i.n(a);n.a},"5e4d":function(e,t,i){},6341:function(e,t,i){},6721:function(e,t,i){},7399:function(e,t,i){},7701:function(e,t,i){"use strict";var a=i("4b7f"),n=i.n(a);n.a},"79d3":function(e,t,i){},8120:function(e,t,i){"use strict";var a=i("3808"),n=i.n(a);n.a},8443:function(e,t,i){},"858f":function(e,t,i){},"88cd":function(e,t,i){},"893e":function(e,t,i){"use strict";var a=i("f242"),n=i.n(a);n.a},9997:function(e,t,i){},"9e7d":function(e,t,i){},"9f69":function(e,t,i){"use strict";var a=i("88cd"),n=i.n(a);n.a},a155:function(e,t,i){"use strict";var a=i("9997"),n=i.n(a);n.a},a630c:function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("2b0e"),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[e.showTop?i("NavBar"):e._e(),e.showTop?i("header",{staticClass:"font-weight-light",attrs:{id:"title"}},[e._v(" STORY EDITOR ")]):e._e(),i("router-view",{on:{evtGoFull:e.goFull,evtExitFull:e.exitFull}})],1)},s=[],r=i("35e0"),o=i("23e8"),l={name:"Editor",title:"MyTale - Make Your Own Social Stories",components:{NavBar:r["a"]},data:function(){return{showTop:!0}},methods:{goFull:function(){this.showTop=!1},exitFull:function(){this.showTop=!0}},mixins:[o["a"]],created:function(){this.storageAvailable("sessionStorage")?(console.log("SESSION STORAGE EXISTS: "+sessionStorage.getItem("storyLocation")),this.$store.commit("updateDirectory",{searchLocation:sessionStorage.getItem("storyLocation")}),this.$store.commit("updateContent",{content:sessionStorage.getItem("storyContent")})):console.log("NO SESSION STORAGE")}},c=l,d=(i("c33c"),i("2877")),u=i("6544"),h=i.n(u),m=i("7496"),v=Object(d["a"])(c,n,s,!1,null,"592541eb",null),p=v.exports;h()(v,{VApp:m["a"]});var f=i("402c"),g=i("4360"),y=i("b84b"),b=i("8aa5"),_=i.n(b),k=i("1543"),w=i("8c4f"),N=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"editor"},[i("v-card",{staticClass:"column",attrs:{fluid:"",outlined:"",id:"toolBar",width:this.toolsWidth,height:this.contentHeight}},[i("gso",{key:this.renderHints.gsoRenderKey,attrs:{isLoggedIn:this.isLoggedIn,storyName:this.storyName,minimized:this.hideItem},on:{evtDownloadStory:e.downloadStory,evtViewHTML:e.viewStoryHTML,evtNewStoryName:e.changeStoryName,evtSave:e.saveStoryToProfile,evtPublish:e.getExportFile,evtNewStory:e.loadTwee,evtCreateNewStory:e.loadStoryTemplate}}),i("v-toolbar",{attrs:{color:"orange darken-2",flat:"",dark:""}},[i("v-toolbar-title",[i("h4",[e._v("TOOLS")])]),i("v-spacer"),i("v-btn",{attrs:{fab:"",light:"","x-small":""},on:{click:e.hideTools}},[i("v-icon",[e._v(e._s(e.toolButton))])],1)],1),i("v-tabs",{attrs:{vertical:"",color:"orange darken-2"}},[i("v-tab",{on:{click:function(t){e.renderHints.inVariableEditor=!0,e.renderHints.inMediaEditor=!1,e.hideThemes()}}},[i("h5",[e._v("Text")])]),i("v-tab",{on:{click:function(t){e.renderHints.inVariableEditor=!1,e.renderHints.inMediaEditor=!0,e.hideThemes()}}},[i("h5",[e._v("Media")])]),i("v-tab",{on:{click:function(t){e.renderHints.inVariableEditor=!1,e.renderHints.inMediaEditor=!1,e.showThemes()}}},[i("h5",[e._v("Themes")])]),i("v-tab",{on:{click:function(t){e.renderHints.inVariableEditor=!1,e.renderHints.inMediaEditor=!1,e.hideThemes()}}},[i("h5",[e._v("Passages")])]),i("v-tab-item",{attrs:{hidden:this.hideItem}},[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("var-sidebar",{key:this.renderHints.variableRenderKey,attrs:{id:"var_sidebar",storyVars:this.storyVariables},on:{evtVarValueChange:e.setVariable,evtVarNameChange:e.setVariableName,evtDelete:e.deleteVariable,evtDispVars:e.regenerateStoryText,evtNewVar:e.addNewVariable}})],1)],1)],1),i("v-tab-item",{attrs:{hidden:this.hideItem}},[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("media-sidebar",{key:this.renderHints.mediaRenderKey,attrs:{id:"media_sidebar",imageVars:this.imageVariables,audioVars:this.audioVariables,status:this.status},on:{evtDispVars:e.regenerateStoryText,evtReplaceImage:e.replaceImage,evtReplaceAudio:e.replaceAudio,evtAudioNameChange:e.replaceAudioName,evtImageNameChange:e.replaceImageName,evtNewImageVariable:e.addImageVariable,evtNewAudioVariable:e.addAudioVariable,evtAddImage:e.addImageToPage,evtAddAudio:e.addAudioToPage,evtRemoveImage:e.removeImageVariable,evtRemoveAudio:e.removeAudioVariable}})],1)],1)],1),i("v-tab-item",{attrs:{hidden:this.hideItem}},[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("themes-sidebar",{attrs:{id:"themes_sidebar",backgroundColor:this.storyPages[this.currentPage-1].extractCSSProperty("background-color"),textColor:this.storyPages[this.currentPage-1].extractCSSProperty("color")},on:{evtNewTheme:e.setTheme,evtNewThemeAll:e.setThemeAll}})],1)],1)],1),i("v-tab-item",{attrs:{hidden:this.hideItem}},[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("passage-sidebar",{key:this.renderHints.passageRenderKey,attrs:{id:"passage_sidebar",storyPages:this.storyPages,currPassage:this.storyPages[this.currentPage-1].pageName},on:{evtNewPassageName:e.updatePassageName,evtRemoveLink:e.removeLink,evtAddLink:e.addLink,evtGoToPage:e.goToPage,evtCreateNew:e.addPage,evtDelete:e.deletePassage}})],1)],1)],1)],1),i("div",{staticStyle:{"border-top":"solid 2px lightgray",padding:"10px"}},[i("v-card-text",[e._v(" Need help using the editor? Visit "),i("a",{attrs:{href:"MyTale Guide.html",target:"_blank"}},[e._v("Support")]),e._v(". ")])],1)],1),i("v-card",{staticClass:"column",attrs:{outlined:"",id:"storyPage",width:this.pageWidth,height:this.contentHeight}},[i("page-layout",{key:this.renderHints.renderKey,attrs:{id:"page_layout",page:this.storyPages[this.currentPage-1],imageVars:this.imageVariables,audioVars:this.audioVariables,themeView:this.themeView},on:{evtNext:e.nextPage,evtStart:e.goToStart,evtPrev:e.prevPage,evtPassageNameChange:e.updatePassageName,evtPassageChange:e.updatePassage,evtDelete:e.deletePassage,evtMinHeight:e.setMinHeight,evtStartPage:e.setStartPage,removeImageFromPage:e.removeImageFromPage,removeAudioFromPage:e.removeAudioFromPage}}),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{top:"",left:"",absolute:"",icon:"",light:""},on:{click:e.goFullScreen}},"v-btn",n,!1),a),[i("v-icon",[e._v(e._s(e.fullButton))])],1)]}}])},[i("span",[e._v(e._s(e.inFullMode?"Exit Full Screen":"Full Screen"))])])],1)],1)},V=[],S=(i("4160"),i("caad"),i("c975"),i("b0c0"),i("4ec9"),i("d3b7"),i("ac1f"),i("25f0"),i("2532"),i("3ca3"),i("5319"),i("159b"),i("ddb0"),i("2b3d"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"var_sidebar"}},[i("div",{staticStyle:{display:"grid","grid-template-columns":"10fr 1fr","text-align":"center"},attrs:{id:"header"}},[i("h3",{staticStyle:{"padding-top":"5px"}},[e._v("Text Variables")]),i("v-btn",{attrs:{icon:"",id:"hide"},on:{click:e.emitDispVars}},[i("v-icon",[e._v(e._s(this.hidden?"mdi-eye":"mdi-eye-off"))])],1)],1),i("br"),i("div",{key:this.renderKey,attrs:{id:"var_editors"}},e._l(this.sortedKeys,(function(t,a){return i("var-editor",{key:a,staticClass:"var_editor",attrs:{varName:t,varColor:e.storyVars.get(t).color,initVarVal:e.storyVars.get(t).value},on:{evtGetNextValue:e.emitVarValueChange,evtDelete:e.emitVarDelete,evtNewVarName:e.emitVarNameChange}})})),1),i("br"),i("button",{staticClass:"sidebar_button",attrs:{id:"addButton"},on:{click:e.showAdd}},[i("v-icon",[e._v("mdi-plus")]),e._v(" New Variable")],1),i("br"),i("br"),this.add?i("div",[i("v-combobox",{attrs:{outlined:"",dense:"","hide-details":"",label:"Variable Name",placeholder:"myVar",items:this.myVarNames,id:"newVarName"},on:{change:e.autofillVar},model:{value:e.newVarName,callback:function(t){e.newVarName=t},expression:"newVarName"}}),i("v-combobox",{staticClass:"mt-4 mb-1",attrs:{outlined:"",dense:"","hide-details":"",label:"Value",placeholder:"value",id:"newVarVal"},model:{value:e.newVarValue,callback:function(t){e.newVarValue=t},expression:"newVarValue"}}),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"sidebar_button",attrs:{id:"cancel_new_var"},on:{click:e.showAdd}},"button",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,3115680174)},[i("span",[e._v("Cancel")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"sidebar_button",attrs:{id:"confirm_new_var"},on:{click:e.emitNewVar}},"button",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,1237596292)},[i("span",[e._v("Submit")])])],1):e._e()])}),O=[],x=i("48c3"),P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"var_editor"}},[this.editVar||this.editName?e._e():i("div",{staticStyle:{display:"grid","grid-template-columns":"3fr 4fr 2fr"},attrs:{id:"header"}},[this.editName?e._e():i("button",{staticClass:"sidebar_input no_border",attrs:{id:"edit_var_name"},on:{click:e.showEditVarName}},[i("span",{style:"color:"+this.varColor+";",attrs:{id:"var_name"}},[i("strong",[e._v(e._s(this.editVariableName))])])]),this.editVar?e._e():i("button",{staticClass:"sidebar_input",attrs:{id:"edit_var_val"},on:{click:e.showEditVarValue}},[i("span",{attrs:{id:"var_val"}},[e._v(" "+e._s(this.editVariableValue)+" ")])]),i("div",{staticClass:"delete"},[this.delete?e._e():i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"var_button_delete",icon:""},on:{click:e.showDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-delete")])],1)]}}],null,!1,674096818)},[i("span",[e._v("Delete")])]),this.delete?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"var_button_confirm",icon:""},on:{click:e.emitDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,726617584)},[i("span",[e._v("Confirm")])]):e._e(),this.delete?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"var_button_cancel",icon:""},on:{click:e.showDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,626734082)},[i("span",[e._v("Cancel")])]):e._e()],1)]),this.editName?i("div",{staticStyle:{display:"grid","grid-template-columns":"7fr 2fr"},attrs:{id:"edit_name"}},[i("v-combobox",{attrs:{outlined:"",dense:"","hide-details":"",items:this.myVarNames,id:"new_var_name"},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.emitNewVarName()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.showEditVarName()}]},model:{value:e.newVarName,callback:function(t){e.newVarName=t},expression:"newVarName"}}),i("div",{staticClass:"confirm"},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"confirm_button",attrs:{id:"var_button_cancel_edit",icon:""},on:{click:e.showEditVarName}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-pencil-off")])],1)]}}],null,!1,482371604)},[i("span",[e._v("Cancel")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"cancel_button",attrs:{id:"var_button_confirm_edit",icon:""},on:{click:e.emitNewVarName}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check-bold")])],1)]}}],null,!1,401893939)},[i("span",[e._v("Confirm")])])],1)],1):e._e(),this.editVar?i("div",{staticStyle:{display:"grid","grid-template-columns":"7fr 2fr"},attrs:{id:"edit_var"}},[i("v-combobox",{attrs:{outlined:"",dense:"","hide-details":"",items:this.myProfile,id:"new_var_val"},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.emitNewVarValue()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.showEditVarValue()}]},model:{value:e.newVarValue,callback:function(t){e.newVarValue=t},expression:"newVarValue"}}),i("div",{staticClass:"confirm"},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"confirm_button",attrs:{id:"var_button_cancel_edit_value",icon:""},on:{click:function(t){return e.showEditVarValue()}}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-pencil-off")])],1)]}}],null,!1,1675336081)},[i("span",[e._v("Cancel")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"cancel_button",attrs:{id:"var_button_confirm_edit_value",icon:""},on:{click:function(t){return e.emitNewVarValue()}}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check-bold")])],1)]}}],null,!1,1190316406)},[i("span",[e._v("Confirm")])])],1)],1):e._e()])},C=[],T=(i("498a"),{name:"var-editor",props:{varName:String,initVarVal:String,varColor:String},data:function(){return{newVarValue:this.initVarVal,prevVarValue:this.initVarVal,newVarName:this.varName.replace("$",""),prevVarName:this.varName.replace("$",""),editName:!1,editVar:!1,delete:!1,userID:"",myProfile:[],myVarNames:[]}},computed:{editVariableValue:function(){var e=this.newVarValue;return e=e.replace(/&quot;/g,'"'),e=e.replace(/&#39;/g,"'"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e},emitVariableValue:function(){var e=this.newVarValue;return e=e.replace(/"/g,"&quot;"),e=e.replace(/'/g,"&#39;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e.trim()},editVariableName:function(){var e=this.newVarName;return e=e.replace("$",""),e.trim()},emitVariableName:function(){var e=this.newVarName;return e.includes("$")||(e="$"+e),e.trim()}},methods:{showEditVarName:function(){this.delete=!1,this.editName=!this.editName,this.editName||(this.newVarName=this.prevVarName)},emitNewVarName:function(){var e,t=document.getElementById("new_var_name");for(this.newVarName=t.value,this.$emit("evtNewVarName",{prevName:"$"+this.prevVarName,newName:this.emitVariableName}),console.log(JSON.stringify({prevName:"$"+this.prevVarName,newName:this.emitVariableName})),this.prevVarName=this.newVarName,this.editName=!this.editName,e=0;e<this.myVarNames.length;e++)if(this.newVarName===this.myVarNames[e]){this.newVarValue=this.myProfile[e],this.prevVarValue=this.newVarValue;var i={name:this.emitVariableName,value:this.emitVariableValue};return this.$emit("evtGetNextValue",i),void console.log(JSON.stringify(i))}},showEditVarValue:function(){this.delete=!1,this.editVar=!this.editVar,this.editVar||(this.newVarValue=this.prevVarValue)},emitNewVarValue:function(){var e=document.getElementById("new_var_val");this.newVarValue=e.value,this.prevVarValue=this.newVarValue;var t={name:this.emitVariableName,value:this.emitVariableValue};this.$emit("evtGetNextValue",t),console.log(JSON.stringify(t)),this.editVar=!this.editVar},showDelete:function(){this.delete=!this.delete},emitDelete:function(){this.$emit("evtDelete",{name:this.varName})}},created:function(){this.userID=_.a.auth().currentUser.uid,this.myProfile=this.getVarVals(this.userID),this.myVarNames=this.getVarNames(this.userID)},mixins:[x["a"]]}),E=T,R=(i("0c59"),i("8336")),j=i("2b5d"),H=i("132d"),D=i("3a2f"),A=Object(d["a"])(E,P,C,!1,null,"ca88a16a",null),I=A.exports;h()(A,{VBtn:R["a"],VCombobox:j["a"],VIcon:H["a"],VTooltip:D["a"]});var M={name:"var-sidebar",props:{storyVars:Map},data:function(){return{hidden:!0,add:!1,newVarName:"",newVarValue:"",myProfile:[],myVarNames:[],renderKey:0}},components:{"var-editor":I},computed:{sortedKeys:function(){var e=[],t=this.storyVars;return null!=t&&(t.forEach((function(t,i){e.push(i)})),e=e.sort((function(e,i){var a=t.get(e).id,n=t.get(i).id;return a-n}))),e}},methods:{emitDispVars:function(){this.hidden=!this.hidden,this.$emit("evtDispVars",{disp:this.hidden})},emitVarValueChange:function(e){this.$emit("evtVarValueChange",e)},emitVarDelete:function(e){this.$emit("evtDelete",e)},emitVarNameChange:function(e){if(""!=e.newName)return this.sortedKeys.includes(e.newName)?(alert("The variable name "+e.newName+" is already being used! Please pick another name."),this.renderKey++,void(this.renderKey>10&&(this.renderKey=0))):void this.$emit("evtVarNameChange",e);alert("Please enter something!")},showAdd:function(){this.add=!this.add},emitNewVar:function(){var e=document.getElementById("newVarName"),t=document.getElementById("newVarVal");this.newVarName=e.value,this.newVarValue=t.value,this.add=!this.add,this.$emit("evtNewVar",{name:"$"+this.newVarName,value:this.newVarValue}),this.newVarName="",this.newVarValue=""},autofillVar:function(){var e;for(e=0;e<this.myVarNames.length;e++)if(this.newVarName===this.myVarNames[e])return void(this.newVarValue=this.myProfile[e])}},created:function(){},mixins:[x["a"]]},K=M,F=(i("c83e"),Object(d["a"])(K,S,O,!1,null,"91bcc4d8",null)),L=F.exports;h()(F,{VBtn:R["a"],VCombobox:j["a"],VIcon:H["a"],VTooltip:D["a"]});var $=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"media_sidebar"}},[i("div",{staticStyle:{display:"grid","grid-template-columns":"10fr 1fr","text-align":"center"},attrs:{id:"header"}},[i("h3",{staticStyle:{"padding-top":"5px"}},[e._v("Media Variables")]),i("v-btn",{attrs:{icon:"",id:"hide"},on:{click:e.emitDispVars}},[i("v-icon",[e._v(e._s(this.hidden?"mdi-eye":"mdi-eye-off"))])],1)],1),i("br"),""!=this.status?i("div",[i("p",[e._v(e._s(this.status))])]):e._e(),i("div",{attrs:{id:"spacer"}},[i("upload-list",{staticClass:"list",attrs:{purpose:"Images",varMap:this.imageVars},on:{evtReplaceFile:e.replaceImage,evtNewMediaVariables:e.emitNewImageVariable,evtNewVarName:e.emitImageVarNameChange,evtAdd:e.emitAddImageToPage,evtDelete:e.emitRemoveImage}}),i("br"),i("upload-list",{staticClass:"list",attrs:{purpose:"Audio",varMap:this.audioVars},on:{evtReplaceFile:e.replaceAudio,evtNewMediaVariables:e.emitNewAudioVariable,evtNewVarName:e.emitAudioVarNameChange,evtAdd:e.emitAddAudioToPage,evtDelete:e.emitRemoveAudio}})],1)])},z=[],U=(i("4de4"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"upload_list"}},[i("div",{attrs:{id:"flex_div"}},[i("button",{staticClass:"sidebar_button",attrs:{id:"list_view"},on:{click:e.listView}},[e._v(e._s(this.purpose)+" "),i("v-icon",[e._v(e._s(this.showList?"mdi-chevron-down":"mdi-chevron-right"))])],1),i("label",{staticClass:"sidebar_button",attrs:{id:"upload_btn"}},[e._v("Upload "+e._s(this.purpose)+" "),i("v-icon",[e._v(e._s(this.icon))]),i("input",{attrs:{type:"file",multiple:"",accept:this.filesAccepted},on:{change:e.emitNewVariables}})],1)]),this.showList?i("div",{key:e.renderKey,staticStyle:{"padding-top":"5px","padding-bottom":"5px"},attrs:{id:"list_div"}},[0==this.varMap.size?i("label",[e._v("No Uploaded Files")]):e._e(),e._l(this.sortedKeys,(function(t,a){return i("sidebar-element",{key:a,staticClass:"list_element",attrs:{fileName:e.varMap.get(t).fileName,variableName:t,type:e.type,varColor:e.varMap.get(t).color},on:{evtAdd:e.addElement,evtDelete:e.removeElement,evtNewVarName:e.updateVarName,evtReplaceFile:e.replaceFile}})}))],2):e._e()])}),B=[],G=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"list_elem"}},[i("div",{attrs:{id:"header"}},[this.editName?e._e():i("button",{staticClass:"sidebar_input no_border",attrs:{id:"edit_var_name"},on:{click:e.showEditVarName}},[i("span",{style:"color:"+this.varColor+";",attrs:{id:"var_name"}},[i("strong",[e._v(e._s(this.newVarName))])])]),this.editName||""==this.newFileName?e._e():i("div",{staticStyle:{"padding-top":"5px"},attrs:{id:"view_file"}},[this.type.includes("image")?i("div",{staticClass:"input_field sidebar_input"},[this.editName?e._e():i("label",{staticClass:"upload_btn"},[e._v(e._s(this.newFileName)+" "),i("input",{attrs:{type:"file",accept:"image/*"},on:{change:e.emitNewFile}})])]):e._e(),this.type.includes("audio")?i("div",{staticClass:"input_field sidebar_input"},[this.editName?e._e():i("label",{staticClass:"upload_btn"},[e._v(e._s(this.newFileName)+" "),i("input",{attrs:{type:"file",accept:"audio/*"},on:{change:e.emitNewFile}})])]):e._e()]),this.editName||""!=this.newFileName?e._e():i("div",{staticStyle:{"padding-top":"5px"},attrs:{id:"inputs"}},[!this.editName&&this.type.includes("audio")?i("div",{staticClass:"sidebar_input"},[i("label",{staticClass:"upload_btn sidebar_input"},[i("v-icon",[e._v("mdi-upload")]),e._v(" Upload "+e._s(this.type)+" "),i("input",{attrs:{type:"file",accept:"audio/*"},on:{change:e.emitNewFile}})],1)]):e._e(),!this.editName&&this.type.includes("image")?i("div",{staticClass:"sidebar_input"},[i("label",{staticClass:"upload_btn"},[i("v-icon",[e._v("mdi-upload")]),e._v(" Upload "+e._s(this.type)+" "),i("input",{attrs:{type:"file",accept:"image/*"},on:{change:e.emitNewFile}})],1)]):e._e()]),this.editName||this.deleteOptions?e._e():i("div",{staticClass:"options"},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_delete",icon:""},on:{click:e.viewDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-delete")])],1)]}}],null,!1,3225438258)},[i("span",[e._v("Delete Media Variable")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_select",icon:""},on:{click:e.emitAdd}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-plus")])],1)]}}],null,!1,314965024)},[i("span",[e._v("Add Media To Current Page")])])],1),!this.editName&&this.deleteOptions?i("div",{staticClass:"confirm",staticStyle:{display:"inline block"}},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"cancel_button",attrs:{id:"list_revert",icon:""},on:{click:e.viewDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,1210240009)},[i("span",[e._v("Cancel")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"confirm_button",attrs:{id:"list_permadelete",icon:""},on:{click:e.emitDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,869036357)},[i("span",[e._v("Confirm")])])],1):e._e()]),this.editName?i("div",{attrs:{id:"edit_name"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.newVarName,expression:"newVarName"}],staticClass:"n_var",style:"font-weight: bold;",domProps:{value:e.newVarName},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.emitNewVarName(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.showEditVarName(t)}],input:function(t){t.target.composing||(e.newVarName=t.target.value)}}}),i("div",{staticClass:"confirm"},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"cancel_button",attrs:{id:"var_button_cancel_edit",icon:""},on:{click:e.showEditVarName}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-pencil-off")])],1)]}}],null,!1,710767872)},[i("span",[e._v("Cancel")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"confirm_button",attrs:{id:"var_button_confirm_edit",icon:""},on:{click:e.emitNewVarName}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check-bold")])],1)]}}],null,!1,1086678919)},[i("span",[e._v("Confirm")])])],1)]):e._e()])},J=[],W={name:"sidebar-element",props:{fileName:String,variableName:String,varColor:String,type:String},data:function(){return{newFileName:this.fileName,newVarName:this.variableName.replace("@",""),prevVarName:this.variableName.replace("@",""),editName:!1,deleteOptions:!1}},methods:{showEditVarName:function(){this.editName=!this.editName,this.editName||(this.newVarName=this.prevVarName)},viewDelete:function(){this.deleteOptions=!this.deleteOptions},emitAdd:function(){this.$emit("evtAdd",{name:"@"+this.newVarName,fileName:this.fileName})},emitDelete:function(){this.$emit("evtDelete",{name:"@"+this.newVarName,fileName:this.fileName}),this.deleteOptions=!1},emitNewVarName:function(){this.$emit("evtNewVarName",{prevName:"@"+this.prevVarName,newName:"@"+this.newVarName,fileName:this.fileName}),this.prevVarName=this.newVarName,this.editName=!1},emitNewFile:function(e){var t=e.target.files[0];this.$emit("evtReplaceFile",{name:"@"+this.newVarName,oldFileName:this.fileName,newFile:t})}}},q=W,Y=(i("9f69"),Object(d["a"])(q,G,J,!1,null,"b7ef7f04",null)),X=Y.exports;h()(Y,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var Z={name:"upload-list",components:{"sidebar-element":X},props:{purpose:String,varMap:Map},data:function(){return{icon:"mdi-upload",numVarsEmitted:1,type:"",showList:!0,filesAccepted:"",renderKey:1}},created:function(){this.purpose.includes("Images")&&(this.icon="mdi-image-area",this.filesAccepted="image/*",this.type="image"),this.purpose.includes("Audio")&&(this.icon="mdi-volume-high",this.filesAccepted="audio/*",this.type="audio")},computed:{sortedKeys:function(){var e=[],t=this.varMap;return null!=t&&(t.forEach((function(t,i){e.push(i)})),e=e.sort((function(e,i){var a=t.get(e).id,n=t.get(i).id;return a-n}))),e}},methods:{listView:function(){this.showList=!this.showList},emitNewVariables:function(e){var t=[];console.log("Emitting new Variables: "+e.target.files.length);for(var i="",a=0;a<e.target.files.length;a++)this.containsFile(e.target.files[a])?i+=" "+e.target.files[a].name+" ":t.push(e.target.files[a]);0!=i.length&&(i="You have already uploaded "+i,alert(i));for(var n=[],s=0;s<t.length;s++){var r={name:"@"+this.type+(this.numVarsEmitted+this.varMap.size),file:t[s],fileName:t[s].name,path:{i:URL.createObjectURL(t[s])},color:"",id:0,uploaded:!1};while(this.containsVar("@"+this.type+(this.numVarsEmitted+++this.varMap.size)))r.name="@"+this.type+(this.numVarsEmitted+this.varMap.size);n.push(r)}n.length>0&&this.$emit("evtNewMediaVariables",n)},addElement:function(e){this.$emit("evtAdd",e)},removeElement:function(e){console.log("Deleting: "+JSON.stringify(e));var t=this.varMap.get(e.name);this.$emit("evtDelete",{name:e.name,fileName:e.fileName,file:t})},updateVarName:function(e){if(e.prevName!=e.newName){if(""!=e.newName)return this.containsVar(e.newName)?(alert("The variable name "+e.newName+" is already being used! Please pick another name."),this.renderKey++,void(this.renderKey>10&&(this.renderKey=0))):void this.$emit("evtNewVarName",e);alert("Please enter something!")}},replaceFile:function(e){var t=e.newFile,i=JSON.parse(JSON.stringify(this.varMap.get(e.name)));if(this.containsFile(t))alert("You've already uploaded "+t.name+"!");else{var a=this.varMap.get(e.name);a.file=e.newFile,a.fileName=e.newFile.name,URL.revokeObjectURL(a.path.i),a.path={i:URL.createObjectURL(e.newFile)},this.$emit("evtReplaceFile",{name:e.name,oldData:i,data:a})}},containsFile:function(e){var t=!1;return this.varMap.forEach((function(i){i.fileName==e.name&&(t=!0)})),t},containsVar:function(e){var t=!1;return this.varMap.forEach((function(i,a){a==e&&(t=!0)})),t}}},Q=Z,ee=(i("8120"),Object(d["a"])(Q,U,B,!1,null,"08e9eaaa",null)),te=ee.exports;h()(ee,{VIcon:H["a"]});var ie={name:"media-sidebar",components:{"upload-list":te},props:{status:String,imageVars:Map,audioVars:Map},data:function(){return{hidden:!0}},created:function(){},methods:{processImages:function(e){for(var t=e.files,i=e.data,a=0;a<t.length;a++){for(var n=t[a],s=new Blob([n],{type:n.type}),r=URL.createObjectURL(s),o="image",l="",c=0;c<i.length;c++)i[c].fileName==n.name&&(l=i[c].varName);this.allImages.push({file:n,fileName:n.name,varName:l,path:r,type:o,id:"",storeStatus:"new"})}this.allImages=this.allImages.filter((function(e){if(null!=e.path)return e})),this.$emit("evtImageUpdate",this.allImages)},processAudio:function(e){var t=e.files,i=e.data;this.allAudio=[];for(var a=0;a<t.length;a++){for(var n=t[a],s=new Blob([n],{type:n.type}),r=URL.createObjectURL(s),o="audio",l="",c=0;c<i.length;c++)i[c].fileName==n.name&&(l=i[c].varName);this.allAudio.push({file:n,fileName:n.name,varName:l,path:r,type:o,id:""})}this.$emit("evtAudioUpdate",this.allAudio)},emitAudioVarNameChange:function(e){this.$emit("evtAudioNameChange",e)},emitImageVarNameChange:function(e){this.$emit("evtImageNameChange",e)},emitNewImageVariable:function(e){this.$emit("evtNewImageVariable",e)},emitNewAudioVariable:function(e){this.$emit("evtNewAudioVariable",e)},replaceImage:function(e){this.$emit("evtReplaceImage",e)},replaceAudio:function(e){this.$emit("evtReplaceAudio",e)},emitAddImageToPage:function(e){this.$emit("evtAddImage",e)},emitAddAudioToPage:function(e){this.$emit("evtAddAudio",e)},emitRemoveImage:function(e){this.$emit("evtRemoveImage",e)},emitDispVars:function(){this.hidden=!this.hidden,this.$emit("evtDispVars",{disp:this.hidden})},emitRemoveAudio:function(e){this.$emit("evtRemoveAudio",e)}}},ae=ie,ne=(i("a648"),Object(d["a"])(ae,$,z,!1,null,"bcfb4d3c",null)),se=ne.exports;h()(ne,{VBtn:R["a"],VIcon:H["a"]});var re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"themes_sidebar"},[i("h3",{attrs:{id:"header"}},[e._v("Themes")]),i("br"),i("div",{attrs:{id:"themes"}},[i("div",{attrs:{id:"show_buttons"}},[i("button",{staticClass:"sidebar_button",attrs:{id:"show_themes"},on:{click:e.toggleThemeDisplay}},[i("v-icon",[e._v(e._s(this.displayThemes?"mdi-chevron-down":"mdi-chevron-right"))]),e._v("Show Themes")],1),i("button",{staticClass:"sidebar_button",attrs:{id:"new_theme"},on:{click:e.showNew}},[i("v-icon",[e._v("mdi-plus")]),e._v(" New Theme")],1)]),i("div",{attrs:{id:"add_new_theme"}},[this.newTheme?i("div",{attrs:{id:"new_theme_props"}},[i("label",{attrs:{id:"theme_name"}},[e._v("Theme Name:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.newThemeName,expression:"newThemeName"}],staticClass:"input",attrs:{id:"new_theme_name",type:"text",placeholder:" myTheme"},domProps:{value:e.newThemeName},on:{input:function(t){t.target.composing||(e.newThemeName=t.target.value)}}}),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"sidebar_button",attrs:{id:"cancel_new_theme"},on:{click:e.showNew}},"button",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,2591048583)},[i("span",[e._v("Cancel")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"sidebar_button",attrs:{id:"confirm_new_theme"},on:{click:e.addNewTheme}},"button",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,883205232)},[i("span",[e._v("Submit")])])],1):e._e()]),this.displayThemes?i("div",{key:this.listRenderKey,attrs:{id:"list"}},[0==this.themes.size?i("label",[e._v("No Themes")]):e._e(),e._l(this.themes.keys(),(function(t,a){return i("list-element",{key:a,attrs:{select:!0,name:t,showSelect:!1},on:{evtRemove:e.removeTheme,evtSelect:e.selectTheme,evtSelectAll:e.selectAllTheme}})}))],2):e._e()]),i("color-picker",{staticClass:"color_input",attrs:{purpose:"Change Background Color",initColor:e.background},on:{evtColorChange:e.updateBackgroundColor}}),i("color-picker",{staticClass:"color_input",attrs:{purpose:"Change Text Color",initColor:e.text},on:{evtColorChange:e.updateTextColor}})],1)},oe=[],le=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"color_picker"}},[i("div",{attrs:{id:"header"}},[i("label",{attrs:{id:"purpose"}},[e._v(e._s(this.purpose))]),i("button",{staticClass:"sidebar_button",style:"background-color: "+this.color+";",attrs:{id:"chosen_color"},on:{click:e.showCanvas}})]),this.canvasVisible?i("div",{attrs:{id:"color_picker_flex"}},[i("div",{attrs:{id:"rgb_select"}},[i("v-color-picker",{key:this.canvasRenderKey,attrs:{"hide-mode-switch":"",width:this.canvasWidth,"hide-canvas":!this.canvasVisible,disabled:!this.canvasVisible,id:"color_input"},on:{"update:color":e.showColorChange},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}})],1),i("div",{attrs:{id:"submit"}},[this.colorChanged?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.emitColor}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,3441481390)},[i("span",[e._v("Apply Changes")])]):e._e(),this.colorChanged?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.hideColorChange}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,3104411853)},[i("span",[e._v("Cancel Changes")])]):e._e()],1)]):e._e()])},ce=[],de={name:"color-picker",props:{purpose:String,initColor:String},data:function(){return{color:this.initColor,prevColor:"#FFFFFF",colorChanged:!1,canvasVisible:!1,canvasWidth:300,canvasRenderKey:0}},methods:{emitColor:function(){this.colorChanged?(this.prevColor=this.color,this.$emit("evtColorChange",this.color),this.colorChanged=!1,this.canvasVisible=!1):this.canvasVisible=!1},showColorChange:function(){this.colorChanged=!0},hideColorChange:function(){this.colorChanged=!1,this.color=this.prevColor},showCanvas:function(){this.checkCanvasWidth(),this.canvasVisible=!this.canvasVisible},checkRenderHints:function(){this.canvasRenderKey>10&&(this.canvasRenderKey=0)},checkCanvasWidth:function(){this.canvasWidth=document.getElementById("header").offsetWidth/5*4-40,this.canvasRenderKey++,this.checkRenderHints()}},created:function(){window.addEventListener("resize",this.checkCanvasWidth)},destroyed:function(){window.removeEventListener("resize",this.checkCanvasWidth)}},ue=de,he=(i("443e"),i("03a4")),me=Object(d["a"])(ue,le,ce,!1,null,"b53e85ba",null),ve=me.exports;h()(me,{VBtn:R["a"],VColorPicker:he["a"],VIcon:H["a"],VTooltip:D["a"]});var pe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:this.selected&&this.showSelect?"border-radius: 5px; border: solid #F05E23; border-width: 1px":"",attrs:{id:"list_elem"}},[i("label",{attrs:{id:"list_name"}},[e._v(e._s(this.name))]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"list_delete"},on:{click:e.viewDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-delete")])],1)]}}])},[i("span",[e._v("Delete Theme")])]),!this.deleteOptions&&this.select?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"list_apply_select"},on:{click:e.emitElementSelect}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-arrow-right")])],1)]}}],null,!1,53683346)},[i("span",[e._v('Apply "'+e._s(e.name)+'" to Displayed Page')])]):e._e(),!this.deleteOptions&&this.select?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"list_apply_all"},on:{click:e.emitElementApplyAll}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-clipboard-check-multiple")])],1)]}}],null,!1,4073885864)},[i("span",[e._v('Apply "'+e._s(e.name)+'" to All Pages')])]):e._e(),this.deleteOptions?i("v-btn",{attrs:{id:"list_revert",icon:""},on:{click:e.viewDelete}},[i("v-icon",[e._v("mdi-close")])],1):e._e(),this.deleteOptions?i("v-btn",{attrs:{id:"list_permadelete",icon:""},on:{click:e.emitElementRemove}},[i("v-icon",[e._v("mdi-check")])],1):e._e()],1)},fe=[],ge={name:"list-element",props:{name:String,select:Boolean,showSelect:Boolean},data:function(){return{deleteOptions:!1,selected:!1}},methods:{viewDelete:function(){this.deleteOptions=!this.deleteOptions},emitElementRemove:function(){this.$emit("evtRemove",this.name)},emitElementSelect:function(){this.selected=!this.selected,this.$emit("evtSelect",{name:this.name,selected:this.selected})},emitElementApplyAll:function(){this.selected=!this.selected,this.$emit("evtSelectAll",{name:this.name,selected:this.selected})}}},ye=ge,be=(i("a155"),Object(d["a"])(ye,pe,fe,!1,null,"a4ea8cc2",null)),_e=be.exports;h()(be,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var ke={name:"themes-sidebar",components:{"color-picker":ve,"list-element":_e},props:{backgroundColor:String,textColor:String},data:function(){return{background:this.backgroundColor,text:this.textColor,themes:Map,newThemeName:"",newTheme:!1,showAlert:!1,displayThemes:!1,selectedTheme:"Basic",listRenderKey:0}},methods:{emitColor:function(){this.$emit("evtNewTheme",{bgColor:this.background,textColor:this.text})},updateBackgroundColor:function(e){this.background=e,this.emitColor()},updateTextColor:function(e){this.text=e,this.emitColor()},showNew:function(){this.newTheme=!this.newTheme},addNewTheme:function(){this.themes=this.themes.set(this.newThemeName,{bgColor:this.background,textColor:this.text}),this.newTheme=!1,this.listRenderKey++,this.checkRenderHints()},selectTheme:function(e){this.background=this.themes.get(e.name).bgColor,this.text=this.themes.get(e.name).textColor,this.selectedTheme=e.name,this.emitColor()},selectAllTheme:function(e){this.background=this.themes.get(e.name).bgColor,this.text=this.themes.get(e.name).textColor,this.selectedTheme=e.name,this.$emit("evtNewThemeAll",{bgColor:this.background,textColor:this.text})},removeTheme:function(e){this.themes.delete(e),this.listRenderKey++,this.checkRenderHints()},toggleThemeDisplay:function(){this.displayThemes=!this.displayThemes},checkRenderHints:function(){this.listRenderKey>10&&(this.listRenderKey=1)}},created:function(){this.themes=new Map,this.themes.set("Basic",{bgColor:"#FFFFFF",textColor:"#000000"})}},we=ke,Ne=(i("5759"),Object(d["a"])(we,re,oe,!1,null,"381d3e83",null)),Ve=Ne.exports;h()(Ne,{VIcon:H["a"],VTooltip:D["a"]});var Se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"passage_sidebar"}},[i("h3",[e._v("Passages")]),i("br"),i("div",{attrs:{id:"passages"}},e._l(this.pages,(function(t,a){return i("passage-view",{key:a,attrs:{currPassage:e.currPassage,page:t},on:{evtNewPassageName:e.emitNewPassageName,evtGoToPage:e.emitGoToPage,evtAddLink:e.emitAddLink,evtRemoveLink:e.emitRemoveLink,evtDelete:e.emitDelete}})})),1),i("br"),i("button",{staticClass:"sidebar_button",on:{click:e.showCreate}},[i("v-icon",[e._v("mdi-plus")]),e._v(" New Passage")],1),i("br"),i("br"),this.create?i("div",{attrs:{id:"newPassage"}},[this.create?i("label",{attrs:{id:"new_name"}},[e._v("New Passage Name:")]):e._e(),this.create?i("input",{directives:[{name:"model",rawName:"v-model",value:e.newNameValue,expression:"newNameValue"}],staticClass:"input",attrs:{id:"new_name_val",type:"text",placeholder:" name"},domProps:{value:e.newNameValue},on:{input:function(t){t.target.composing||(e.newNameValue=t.target.value)}}}):e._e(),this.create?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"sidebar_button",attrs:{id:"cancel_new_passage"},on:{click:e.showCreate}},"button",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,1987793244)},[i("span",[e._v("Cancel")])]):e._e(),this.create?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"sidebar_button",attrs:{id:"confirm_new_passage"},on:{click:e.emitCreateNew}},"button",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,1383085298)},[i("span",[e._v("Submit")])]):e._e()],1):e._e()])},Oe=[],xe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:e.currPassage==this.name?"border: solid brown;":"",attrs:{id:"passage_view"}},[i("div",{attrs:{id:"bar"}},[this.delete?i("div",{attrs:{id:"delete"}},[i("h4",{attrs:{id:"sure"}},[e._v("Are You Sure?")]),i("v-btn",{attrs:{icon:"",id:"cancel_del"},on:{click:e.showDelete}},[i("v-icon",[e._v("mdi-close")])],1),i("v-btn",{attrs:{icon:"",id:"conf_del"},on:{click:e.emitDelete}},[i("v-icon",[e._v("mdi-check")])],1)],1):e._e(),this.delete?e._e():i("div",{style:this.editName?"grid-template-columns: 1fr 1fr 5fr 1fr;":"",attrs:{id:"header"}},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"goto"},on:{click:e.emitGoTo}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-eye")])],1)]}}],null,!1,866954679)},[i("span",[e._v('Go To "'+e._s(e.name)+'"')])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"link_list_show"},on:{click:function(t){e.showList(),e.editName=!1}}},"v-btn",n,!1),a),[i("v-icon",[e._v(e._s(e.showLinks?"mdi-chevron-down":"mdi-chevron-right"))])],1)]}}],null,!1,1847126507)},[i("span",[e._v('See Links in "'+e._s(e.name)+'"')])]),this.editName?e._e():i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"link_list_show"},on:{click:e.addLink}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-plus")])],1)]}}],null,!1,4063468513)},[i("span",[e._v('Add Link To "'+e._s(e.name)+'" in displayed passage')])]),this.editName?e._e():i("button",{staticClass:"sidebar_input no_border bold_text",staticStyle:{cursor:"pointer"},on:{click:e.showEditName}},[this.editName?e._e():i("h4",{attrs:{id:"name"}},[e._v(e._s(this.name))])]),this.editName?i("input",{directives:[{name:"model",rawName:"v-model",value:e.newNameVal,expression:"newNameVal"}],staticClass:"sidebar_input bold_text",domProps:{value:e.newNameVal},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.showEditName(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updatePassageName(t)}],blur:e.showEditName,input:function(t){t.target.composing||(e.newNameVal=t.target.value)}}}):e._e(),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"del"},on:{click:function(t){e.showDelete(),e.editName=!1}}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-delete")])],1)]}}],null,!1,2208800802)},[i("span",[e._v("Delete")])])],1)]),this.showLinks?i("div",{key:this.listRenderKey,attrs:{id:"links"}},[e._l(this.links,(function(t,a){return i("list-element",{key:a,attrs:{select:!1,name:t.name,showSelect:!1},on:{evtRemove:e.removeLink}})})),0==this.links.length?i("label",[e._v("No Links in this Passage")]):e._e()],2):e._e()])},Pe=[],Ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:this.selected&&this.showSelect?"border-radius: 5px; border: solid #F05E23; border-width: 1px":"",attrs:{id:"list_elem"}},[i("label",{attrs:{id:"list_name"}},[e._v("Link To: "+e._s(this.name))]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",id:"list_delete"},on:{click:e.viewDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-delete")])],1)]}}])},[i("span",[e._v("Delete Link")])]),!this.deleteOptions&&this.select?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_select",icon:""},on:{click:e.emitElementSelect}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-arrow-right")])],1)]}}],null,!1,2472140921)},[i("span",[e._v("Select Link")])]):e._e(),!this.deleteOptions&&this.select?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_apply_all",icon:""},on:{click:e.emitElementApplyAll}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-clipboard-check-multiple")])],1)]}}],null,!1,1887091176)},[i("span",[e._v("Add Link to All")])]):e._e(),this.deleteOptions?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_revert",icon:""},on:{click:e.viewDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-close")])],1)]}}],null,!1,1644302406)},[i("span",[e._v("Cancel")])]):e._e(),this.deleteOptions?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_permadelete",icon:""},on:{click:e.emitElementRemove}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check")])],1)]}}],null,!1,624849343)},[i("span",[e._v("Confirm")])]):e._e()],1)},Te=[],Ee={name:"list-element",props:{name:String,select:Boolean,showSelect:Boolean},data:function(){return{deleteOptions:!1,selected:!1}},methods:{viewDelete:function(){this.deleteOptions=!this.deleteOptions},emitElementRemove:function(){this.$emit("evtRemove",this.name)},emitElementSelect:function(){this.selected=!this.selected,this.$emit("evtSelect",{name:this.name,selected:this.selected})},emitElementApplyAll:function(){this.selected=!this.selected,this.$emit("evtSelectAll",{name:this.name,selected:this.selected})}}},Re=Ee,je=(i("ade2"),Object(d["a"])(Re,Ce,Te,!1,null,"3fdafe78",null)),He=je.exports;h()(je,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var De=i("736e"),Ae=i.n(De),Ie={name:"passage_view",props:{page:Ae.a,currPassage:String},components:{"list-element":He},data:function(){return{name:this.page.pageName,links:this.page.links,newNameVal:this.page.pageName,prevNameVal:this.page.pageName,editName:!1,showLinks:!1,delete:!1,listRenderKey:0}},methods:{emitGoTo:function(){this.$emit("evtGoToPage",{name:this.name})},emitDelete:function(){this.$emit("evtDelete",{name:this.name})},removeLink:function(e){this.links=this.links.filter((function(t){return t.name!=e})),this.$emit("evtRemoveLink",{name:this.name,removeLink:e}),this.listRenderKey++,this.checkRenderHints()},addLink:function(){this.$emit("evtAddLink",{name:this.name})},showList:function(){this.showLinks=!this.showLinks},showEditName:function(){this.editName=!this.editName,this.editName||(this.newNameVal=this.prevNameVal)},showDelete:function(){this.delete=!this.delete},updatePassageName:function(){for(var e=!0,t=0;t<this.page.story.passages.length;t++)this.page.story.passages[t].name==this.newNameVal&&this.newNameVal!=this.prevNameVal&&(e=!1);e?(this.$emit("evtNewPassageName",{prevName:this.name,newName:this.newNameVal}),this.editName=!this.editName,this.prevNameVal=this.newNameVal):alert("Name already exists")},checkRenderHints:function(){this.listRenderKey>10&&(this.listRenderKey=0)}}},Me=Ie,Ke=(i("323f"),Object(d["a"])(Me,xe,Pe,!1,null,"518438de",null)),Fe=Ke.exports;h()(Ke,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var Le={name:"sidebar-passage",components:{"passage-view":Fe},props:{storyPages:Array,currPassage:String},data:function(){return{pages:this.storyPages,create:!1,newNameValue:""}},methods:{emitNewPassageName:function(e){this.$emit("evtNewPassageName",e)},emitRemoveLink:function(e){this.$emit("evtRemoveLink",e)},emitAddLink:function(e){this.$emit("evtAddLink",e)},emitGoToPage:function(e){this.$emit("evtGoToPage",e)},emitDelete:function(e){this.$emit("evtDelete",e)},emitCreateNew:function(){for(var e=!0,t=0;t<this.storyPages[0].story.passages.length;t++)this.newNameValue==this.storyPages[0].story.passages[t].name&&(alert("Passage already exists"),e=!1);e&&this.$emit("evtCreateNew",{name:this.newNameValue})},showCreate:function(){this.create=!this.create}}},$e=Le,ze=(i("b6a6"),Object(d["a"])($e,Se,Oe,!1,null,"480be7bd",null)),Ue=ze.exports;h()(ze,{VIcon:H["a"],VTooltip:D["a"]});var Be=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"gso"}},[i("div",{style:e.minimized?"grid-template-columns: 1fr":"grid-template-columns: 1fr 10fr 5fr",attrs:{id:"story_options"}},[e.minimized?e._e():i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"upload_btn",icon:""},on:{click:e.uploadFiles}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-upload")])],1)]}}],null,!1,3617159978)},[i("span",[e._v("Upload New Story")])]),e.minimized?e._e():i("input",{ref:"uploader",staticStyle:{display:"none"},attrs:{type:"file",accept:".twee"},on:{change:e.emitFiles}}),this.editName?e._e():i("button",{class:e.minimized?"":"border_button",staticStyle:{cursor:"pointer"},attrs:{disabled:e.minimized},on:{click:e.showEditName}},[this.editName?e._e():i("h4",{style:e.minimized?"font-size: 15px; font-weight: bold;":"",attrs:{id:"name"}},[e._v(e._s(this.newNameVal))])]),this.editName&&!e.minimized?i("input",{directives:[{name:"model",rawName:"v-model",value:e.newNameVal,expression:"newNameVal"}],attrs:{id:"passageName"},domProps:{value:e.newNameVal},on:{blur:e.updateStoryName,keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.showEditName(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateStoryName(t)}],input:function(t){t.target.composing||(e.newNameVal=t.target.value)}}}):e._e(),e.minimized?e._e():i("div",{attrs:{id:"button_section"}},[e.editName?i("div",{staticClass:"flex_disp",attrs:{id:"confirm_edit"}},[i("div",[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{id:"cancel",icon:""},on:{click:e.showEditName}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-pencil-off")])],1)]}}],null,!1,1246967979)},[i("span",[e._v("Cancel")])])],1),i("div",[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{id:"confirm",icon:""},on:{click:e.updateStoryName}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-check-bold")])],1)]}}],null,!1,1846452643)},[i("span",[e._v("Confirm")])])],1)]):i("div",{staticClass:"flex_disp",style:(e.minimized,""),attrs:{id:"condensed_options"}},[e.showOptions&&e.loggedIn?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{id:"downloadStory",icon:""},on:{click:e.downloadStory}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-download")])],1)]}}],null,!1,2206655582)},[i("span",[e._v("Download Story")])]):e._e(),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{id:"viewStory",icon:""},on:{click:e.viewStoryHTML}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-eye")])],1)]}}],null,!1,3649009422)},[i("span",[e._v("View Story")])]),e.loggedIn&&!e.minimized?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{id:"saveStory",icon:""},on:{click:e.saveStoryToProfile}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-content-save")])],1)]}}],null,!1,1059046335)},[i("span",[e._v("Save Story")])]):e._e(),e.showOptions&&e.loggedIn&&!e.minimized?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("router-link",{attrs:{to:{name:"addStory"}}},[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{id:"publishStory",icon:""},on:{click:e.publishStory}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-cloud-upload")])],1)],1)]}}],null,!1,2005806807)},[i("span",[e._v("Publish Story")])]):e._e(),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"expander",attrs:{small:e.minimized,id:"moreOptions",icon:""},on:{click:e.emitCreateNewStory}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-refresh")])],1)]}}],null,!1,4274292905)},[i("span",[e._v("Create New Story")])])],1)])],1)])},Ge=[],Je={name:"global-story-options",props:{isLoggedIn:Boolean,storyName:String,minimized:Boolean},data:function(){return{showOptions:!0,editName:!1,newNameVal:this.storyName,prevNameVal:this.storyName,theBool:!1}},computed:{loggedIn:function(){return!!this.isLoggedIn}},methods:{downloadStory:function(){this.$emit("evtDownloadStory")},viewStoryHTML:function(){this.$emit("evtViewHTML")},showEditName:function(){this.editName=!this.editName,this.editName||(this.newNameVal=this.prevNameVal)},updateStoryName:function(){this.prevNameVal=this.newNameVal,this.$emit("evtNewStoryName",{name:this.newNameVal}),this.editName=!1},saveStoryToProfile:function(){this.$emit("evtSave")},publishStory:function(){this.$emit("evtPublish")},emitCreateNewStory:function(){this.$emit("evtCreateNewStory")},viewOptions:function(){this.showOptions=!this.showOptions},uploadFiles:function(){this.$refs.uploader.click()},emitFiles:function(e){this.$emit("evtNewStory",e.target.files)}}},We=Je,qe=(i("524e"),Object(d["a"])(We,Be,Ge,!1,null,"f65f9b84",null)),Ye=qe.exports;h()(qe,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var Xe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"page_layout"}},[i("div",{attrs:{id:"header"}},[this.editName?e._e():i("button",{staticStyle:{cursor:"pointer"},on:{click:e.showEditName}},[this.editName?e._e():i("h2",{style:this.starting?"color: green":"",attrs:{id:"name"}},[e._v(e._s(this.passageName))])]),this.editName?i("input",{directives:[{name:"model",rawName:"v-model",value:this.passageName,expression:"this.passageName"}],attrs:{id:"passageName"},domProps:{value:this.passageName},on:{blur:e.updatePassageName,input:function(t){t.target.composing||e.$set(this,"passageName",t.target.value)}}}):e._e(),this.editName?i("div",{staticStyle:{"border-top":"solid 2px lightgray","padding-top":"7px"},attrs:{id:"options"}},[this.delete?e._e():i("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between"},attrs:{id:"passageOptions"}},[i("v-btn",{staticClass:"sameWidth",attrs:{id:"startPassage"},on:{click:function(t){e.emitStartPassage(),e.showEditName()}}},[e._v("Set As Start Passage")]),i("v-btn",{staticClass:"sameWidth",attrs:{id:"cancel"},on:{click:e.showEditName}},[i("v-icon",[e._v("mdi-close")]),e._v(" Cancel")],1),i("v-btn",{staticClass:"sameWidth",attrs:{id:"submit"},on:{click:e.updatePassageName}},[i("v-icon",[e._v("mdi-check")]),e._v(" Submit")],1),i("v-btn",{staticClass:"sameWidth",attrs:{id:"deletePassage"},on:{click:e.showDelete}},[i("v-icon",[e._v("mdi-delete")]),e._v(" Delete Passage")],1)],1),this.delete&&this.editName?i("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-around"},attrs:{id:"deleteOptions"}},[i("v-btn",{staticClass:"sameWidth",attrs:{id:"cancel"},on:{click:e.showDelete}},[i("v-icon",[e._v("mdi-close")]),e._v(" Cancel")],1),i("v-btn",{staticClass:"sameWidth",attrs:{id:"submit"},on:{click:e.emitDelete}},[i("v-icon",[e._v("mdi-check")]),e._v(" Delete")],1)],1):e._e()]):e._e()]),i("div",{attrs:{id:"story_field"}},[this.hasAudioFiles?i("audio-list",{attrs:{audioList:this.audioFiles},on:{removeMediaFromPage:e.removeAudioFromPage}}):e._e(),i("text-editor",{key:e.renderKey,style:this.themeView?this.pageTheme:"",attrs:{dispText:this.dispPassage.text,linkText:this.linkPassage.text,id:"text_field",theme:this.pageTheme},on:{evtPassageChange:e.emitNewPassage}}),this.hasImages?i("div",{attrs:{id:"image_field"}},e._l(this.imageFiles,(function(t,a){return i("image-list",{key:a,staticStyle:{float:"left"},attrs:{imageData:t},on:{removeMediaFromPage:e.removeImageFromPage}})})),1):e._e()],1),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("button",e._g(e._b({staticClass:"layoutbutton",attrs:{id:"prevButton"},on:{click:e.prevPage}},"button",n,!1),a),[i("v-icon",[e._v("mdi-arrow-left")])],1)]}}])},[i("span",[e._v("Back to Previous Page")])]),i("div",{attrs:{id:"linkButtons"}},[i("v-btn",{staticStyle:{margin:"10px"},attrs:{disabled:this.atStart},on:{click:e.emitStartingPage}},[i("v-icon",[e._v("mdi-home")]),e._v("Go To Start")],1),e._l(e.page.links,(function(t,a){return i("v-btn",{key:a,staticStyle:{margin:"10px"},on:{click:function(i){return e.emitPage(t)}}},[e._v(e._s(t.name)),i("v-icon",[e._v("mdi-arrow-right")])],1)}))],2)],1)},Ze=[],Qe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"edit_field"}},[i("button",{staticStyle:{cursor:"pointer"},on:{click:e.switchEdit}},[this.editing?e._e():i("div",{attrs:{id:"not_editing"}},[i("v-card-text",{attrs:{id:"text_display"}},[i("span",{domProps:{innerHTML:e._s(this.textValue)}})])],1)]),this.editing?i("div",{attrs:{id:"is_editing"}},[i("text-tiptap",{key:this.renderKey,class:this.theme,attrs:{text:this.editLinkTextValue,id:"text_edit"},on:{evtPassageChange:e.updatePassage}})],1):e._e(),this.editOptions?i("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-around","border-top":"solid 2px lightgray",padding:"5px"},attrs:{id:"edit_options"}},[i("v-btn",{staticStyle:{width:"20%"},attrs:{id:"confirm_edit"},on:{click:e.switchEdit}},[e._v("Edit")]),i("v-btn",{staticStyle:{width:"20%"},attrs:{id:"cancel_edit"},on:{click:e.showEditOptions}},[e._v("Cancel")])],1):e._e()])},et=[],tt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"editor"},[i("editor-menu-bar",{attrs:{editor:e.editor},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.commands,n=t.isActive,s=t.focused;return[i("div",{staticClass:"menubar",class:{"is-active":s}},[i("button",{staticClass:"menubar__button",class:{"is-active":n.bold()},on:{click:a.bold}},[i("v-icon",{staticClass:"icon"},[e._v("mdi-format-bold")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.italic()},on:{click:a.italic}},[i("v-icon",[e._v("mdi-format-italic")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.strike()},on:{click:a.strike}},[i("v-icon",[e._v("mdi-format-strikethrough-variant")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.underline()},on:{click:a.underline}},[i("v-icon",[e._v("mdi-format-underline")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.heading({level:1})},on:{click:function(e){return a.heading({level:1})}}},[i("v-icon",[e._v("mdi-format-header-1")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.heading({level:2})},on:{click:function(e){return a.heading({level:2})}}},[i("v-icon",[e._v("mdi-format-header-2")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.heading({level:3})},on:{click:function(e){return a.heading({level:3})}}},[i("v-icon",[e._v("mdi-format-header-3")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.bullet_list()},on:{click:a.bullet_list}},[i("v-icon",[e._v("mdi-format-list-bulleted")])],1),i("div",{staticClass:"divider"}),i("button",{staticClass:"menubar__button",class:{"is-active":n.ordered_list()},on:{click:a.ordered_list}},[i("v-icon",[e._v("mdi-format-list-numbers")])],1)])]}}])}),i("editor-content",{staticClass:"editor_content",attrs:{id:"editorStyle",editor:e.editor}}),i("div",{staticClass:"spacing"}),i("v-btn",{attrs:{id:"done_button"},on:{click:function(t){e.emitEdit(),e.switchEdit()}}},[e._v(e._s("Saved!"==this.saveStatus?"Done":"Saving..."))])],1)},it=[],at=(i("99af"),i("13d5"),i("4fad"),i("2ca0"),i("bf19c"),i("3835")),nt=i("ade3"),st=i("53ca"),rt=i("2909"),ot=i("5530"),lt=i("d4ec"),ct=i("bee2"),dt=i("262e"),ut=i("2caf"),ht=i("5313"),mt=i("576a"),vt=i("304a"),pt=i("23f1"),ft=i("1a16"),gt=i("7f06"),yt=i("0010"),bt=i("f95e"),_t=i("a15f"),kt=function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")},wt=function(){function e(t,i){var a=i.editor,n=i.extension,s=i.parent,r=i.node,o=i.view,l=i.decorations,c=i.getPos;Object(lt["a"])(this,e),this.component=t,this.editor=a,this.extension=n,this.parent=s,this.node=r,this.view=o,this.decorations=l,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isMark?this.getMarkPos:c,this.captureEvents=!0,this.dom=this.createDOM(),this.contentDOM=this.vm.$refs.content}return Object(ct["a"])(e,[{key:"createDOM",value:function(){var e=this,t=a["a"].extend(this.component),i={editor:this.editor,node:this.node,view:this.view,getPos:function(){return e.getPos()},decorations:this.decorations,selected:!1,options:this.extension.options,updateAttrs:function(t){return e.updateAttrs(t)}};return"function"===typeof this.extension.setSelection&&(this.setSelection=this.extension.setSelection),"function"===typeof this.extension.update&&(this.update=this.extension.update),this.vm=new t({parent:this.parent,propsData:i}).$mount(),this.vm.$el}},{key:"update",value:function(e,t){return e.type===this.node.type&&(e===this.node&&this.decorations===t||(this.node=e,this.decorations=t,this.updateComponentProps({node:e,decorations:t})),!0)}},{key:"updateComponentProps",value:function(e){var t=this;if(this.vm._props){var i=a["a"].config.silent;a["a"].config.silent=!0,Object.entries(e).forEach((function(e){var i=Object(at["a"])(e,2),a=i[0],n=i[1];t.vm._props[a]=n})),a["a"].config.silent=i}}},{key:"updateAttrs",value:function(e){if(this.view.editable){var t=this.view.state,i=this.node.type,a=this.getPos(),n=Object(ot["a"])(Object(ot["a"])({},this.node.attrs),e),s=this.isMark?t.tr.removeMark(a.from,a.to,i).addMark(a.from,a.to,i.create(n)):t.tr.setNodeMarkup(a,null,n);this.view.dispatch(s)}}},{key:"ignoreMutation",value:function(e){return"selection"!==e.type&&(!this.contentDOM||!this.contentDOM.contains(e.target))}},{key:"stopEvent",value:function(e){var t=this;if("function"===typeof this.extension.stopEvent)return this.extension.stopEvent(e);var i=!!this.extension.schema.draggable;if(i&&"mousedown"===e.type){var a=e.target.closest&&e.target.closest("[data-drag-handle]"),n=a&&(this.dom===a||this.dom.contains(a));n&&(this.captureEvents=!1,document.addEventListener("dragend",(function(){t.captureEvents=!0}),{once:!0}))}var s="copy"===e.type,r="paste"===e.type,o="cut"===e.type,l=e.type.startsWith("drag")||"drop"===e.type;return!(i&&l||s||r||o)&&this.captureEvents}},{key:"selectNode",value:function(){this.updateComponentProps({selected:!0})}},{key:"deselectNode",value:function(){this.updateComponentProps({selected:!1})}},{key:"getMarkPos",value:function(){var e=this.view.posAtDOM(this.dom),t=this.view.state.doc.resolve(e),i=Object(_t["b"])(t,this.node.type);return i}},{key:"destroy",value:function(){this.vm.$destroy()}}]),e}(),Nt=function(){function e(){Object(lt["a"])(this,e)}return Object(ct["a"])(e,[{key:"on",value:function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}},{key:"emit",value:function(e){for(var t=this,i=arguments.length,a=new Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];this._callbacks=this._callbacks||{};var s=this._callbacks[e];return s&&s.forEach((function(e){return e.apply(t,a)})),this}},{key:"off",value:function(e,t){if(arguments.length){var i=this._callbacks?this._callbacks[e]:null;i&&(t?this._callbacks[e]=i.filter((function(e){return e!==t})):delete this._callbacks[e])}else this._callbacks={};return this}}]),e}(),Vt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(lt["a"])(this,e),this.options=Object(ot["a"])(Object(ot["a"])({},this.defaultOptions),t)}return Object(ct["a"])(e,[{key:"init",value:function(){return null}},{key:"bindEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.editor=e}},{key:"inputRules",value:function(){return[]}},{key:"pasteRules",value:function(){return[]}},{key:"keys",value:function(){return{}}},{key:"name",get:function(){return null}},{key:"type",get:function(){return"extension"}},{key:"defaultOptions",get:function(){return{}}},{key:"plugins",get:function(){return[]}}]),e}(),St=(i("d81d"),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0;Object(lt["a"])(this,e),t.forEach((function(e){e.bindEditor(i),e.init()})),this.extensions=t}return Object(ct["a"])(e,[{key:"keymaps",value:function(e){var t=e.schema,i=this.extensions.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.keys})).map((function(e){return e.keys({schema:t})})),a=this.extensions.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.keys})).map((function(e){return e.keys({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(Object(rt["a"])(i),Object(rt["a"])(a)).map((function(e){return Object(gt["keymap"])(e)}))}},{key:"inputRules",value:function(e){var t=e.schema,i=e.excludedExtensions;if(!(i instanceof Array)&&i)return[];var a=i instanceof Array?this.extensions.filter((function(e){return!i.includes(e.name)})):this.extensions,n=a.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.inputRules})).map((function(e){return e.inputRules({schema:t})})),s=a.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.inputRules})).map((function(e){return e.inputRules({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(Object(rt["a"])(n),Object(rt["a"])(s)).reduce((function(e,t){return[].concat(Object(rt["a"])(e),Object(rt["a"])(t))}),[])}},{key:"pasteRules",value:function(e){var t=e.schema,i=e.excludedExtensions;if(!(i instanceof Array)&&i)return[];var a=i instanceof Array?this.extensions.filter((function(e){return!i.includes(e.name)})):this.extensions,n=a.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.pasteRules})).map((function(e){return e.pasteRules({schema:t})})),s=a.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.pasteRules})).map((function(e){return e.pasteRules({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(Object(rt["a"])(n),Object(rt["a"])(s)).reduce((function(e,t){return[].concat(Object(rt["a"])(e),Object(rt["a"])(t))}),[])}},{key:"commands",value:function(e){var t=e.schema,i=e.view;return this.extensions.filter((function(e){return e.commands})).reduce((function(e,a){var n=a.name,s=a.type,r={},o=a.commands(Object(ot["a"])({schema:t},["node","mark"].includes(s)?{type:t["".concat(s,"s")][n]}:{})),l=function(e,t){return!!i.editable&&(i.focus(),e(t)(i.state,i.dispatch,i))},c=function(e,t){Array.isArray(t)?r[e]=function(e){return t.forEach((function(t){return l(t,e)}))}:"function"===typeof t&&(r[e]=function(e){return l(t,e)})};return"object"===Object(st["a"])(o)?Object.entries(o).forEach((function(e){var t=Object(at["a"])(e,2),i=t[0],a=t[1];c(i,a)})):c(n,o),Object(ot["a"])(Object(ot["a"])({},e),r)}),{})}},{key:"nodes",get:function(){return this.extensions.filter((function(e){return"node"===e.type})).reduce((function(e,t){var i=t.name,a=t.schema;return Object(ot["a"])(Object(ot["a"])({},e),{},Object(nt["a"])({},i,a))}),{})}},{key:"options",get:function(){var e=this.view;return this.extensions.reduce((function(t,i){return Object(ot["a"])(Object(ot["a"])({},t),{},Object(nt["a"])({},i.name,new Proxy(i.options,{set:function(t,i,a){var n=t[i]!==a;return Object.assign(t,Object(nt["a"])({},i,a)),n&&e.updateState(e.state),!0}})))}),{})}},{key:"marks",get:function(){return this.extensions.filter((function(e){return"mark"===e.type})).reduce((function(e,t){var i=t.name,a=t.schema;return Object(ot["a"])(Object(ot["a"])({},e),{},Object(nt["a"])({},i,a))}),{})}},{key:"plugins",get:function(){return this.extensions.filter((function(e){return e.plugins})).reduce((function(e,t){var i=t.plugins;return[].concat(Object(rt["a"])(e),Object(rt["a"])(i))}),[])}}]),e}()),Ot=function(e){var t=document.createElement("style");t.type="text/css",t.textContent=e;var i=document,a=i.head,n=a.firstChild;n?a.insertBefore(t,n):a.appendChild(t)};function xt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(parseInt(e,10),t),i)}var Pt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(lt["a"])(this,i),t.call(this,e)}return Object(ct["a"])(i,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"node"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),i}(Vt),Ct=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"name",get:function(){return"doc"}},{key:"schema",get:function(){return{content:"block+"}}}]),i}(Pt),Tt=i("a9de"),Et=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"commands",value:function(e){var t=e.type;return function(){return Object(Tt["f"])(t)}}},{key:"name",get:function(){return"paragraph"}},{key:"schema",get:function(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function(){return["p",0]}}}}]),i}(Pt),Rt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"name",get:function(){return"text"}},{key:"schema",get:function(){return{group:"inline"}}}]),i}(Pt),jt=i("858f"),Ht=i.n(jt),Dt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(lt["a"])(this,i),e=t.call(this),e.defaultOptions={editorProps:{},editable:!0,autoFocus:null,extensions:[],content:"",topNode:"doc",emptyDocument:{type:"doc",content:[{type:"paragraph"}]},useBuiltInExtensions:!0,disableInputRules:!1,disablePasteRules:!1,dropCursor:{},parseOptions:{},injectCSS:!0,onInit:function(){},onTransaction:function(){},onUpdate:function(){},onFocus:function(){},onBlur:function(){},onPaste:function(){},onDrop:function(){}},e.events=["init","transaction","update","focus","blur","paste","drop"],e.init(a),e}return Object(ct["a"])(i,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions(Object(ot["a"])(Object(ot["a"])({},this.defaultOptions),t)),this.focused=!1,this.selection={from:0,to:0},this.element=document.createElement("div"),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.plugins=this.createPlugins(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),this.options.injectCSS&&Ot(Ht.a),null!==this.options.autoFocus&&this.focus(this.options.autoFocus),this.events.forEach((function(t){e.on(t,e.options[kt("on ".concat(t))]||function(){})})),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view}},{key:"setOptions",value:function(e){this.options=Object(ot["a"])(Object(ot["a"])({},this.options),e),this.view&&this.state&&this.view.updateState(this.state)}},{key:"createExtensions",value:function(){return new St([].concat(Object(rt["a"])(this.builtInExtensions),Object(rt["a"])(this.options.extensions)),this)}},{key:"createPlugins",value:function(){return this.extensions.plugins}},{key:"createKeymaps",value:function(){return this.extensions.keymaps({schema:this.schema})}},{key:"createInputRules",value:function(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}},{key:"createPasteRules",value:function(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}},{key:"createCommands",value:function(){return this.extensions.commands({schema:this.schema,view:this.view})}},{key:"createNodes",value:function(){return this.extensions.nodes}},{key:"createMarks",value:function(){return this.extensions.marks}},{key:"createSchema",value:function(){return new vt["Schema"]({topNode:this.options.topNode,nodes:this.nodes,marks:this.marks})}},{key:"createState",value:function(){var e=this;return ht["EditorState"].create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[].concat(Object(rt["a"])(this.plugins),[Object(bt["b"])({rules:this.inputRules})],Object(rt["a"])(this.pasteRules),Object(rt["a"])(this.keymaps),[Object(gt["keymap"])({Backspace:bt["d"]}),Object(gt["keymap"])(yt["a"]),Object(pt["a"])(this.options.dropCursor),Object(ft["a"])(),new ht["Plugin"]({key:new ht["PluginKey"]("editable"),props:{editable:function(){return e.options.editable}}}),new ht["Plugin"]({props:{attributes:{tabindex:0},handleDOMEvents:{focus:function(t,i){e.focused=!0,e.emit("focus",{event:i,state:t.state,view:t});var a=e.state.tr.setMeta("focused",!0);e.view.dispatch(a)},blur:function(t,i){e.focused=!1,e.emit("blur",{event:i,state:t.state,view:t});var a=e.state.tr.setMeta("focused",!1);e.view.dispatch(a)}}}}),new ht["Plugin"]({props:this.options.editorProps})])})}},{key:"createDocument",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.parseOptions;if(null===e)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"===Object(st["a"])(e))try{return this.schema.nodeFromJSON(e)}catch(a){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",a),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"===typeof e){var i=document.createElement("div");return i.innerHTML=e.trim(),vt["DOMParser"].fromSchema(this.schema).parse(i,t)}return!1}},{key:"createView",value:function(){var e=this;return new mt["EditorView"](this.element,{state:this.createState(),handlePaste:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];e.emit.apply(e,["paste"].concat(i))},handleDrop:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];e.emit.apply(e,["drop"].concat(i))},dispatchTransaction:this.dispatchTransaction.bind(this)})}},{key:"setParentComponent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this.view.setProps({nodeViews:this.initNodeViews({parent:e,extensions:[].concat(Object(rt["a"])(this.builtInExtensions),Object(rt["a"])(this.options.extensions))})})}},{key:"initNodeViews",value:function(e){var t=this,i=e.parent,a=e.extensions;return a.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.view})).reduce((function(e,a){var n=function(e,n,s,r){var o=a.view;return new wt(o,{editor:t,extension:a,parent:i,node:e,view:n,getPos:s,decorations:r})};return Object(ot["a"])(Object(ot["a"])({},e),{},Object(nt["a"])({},a.name,n))}),{})}},{key:"dispatchTransaction",value:function(e){var t=this.state.apply(e);this.view.updateState(t),this.selection={from:this.state.selection.from,to:this.state.selection.to},this.setActiveNodesAndMarks(),this.emit("transaction",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emitUpdate(e)}},{key:"emitUpdate",value:function(e){this.emit("update",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:e})}},{key:"resolveSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.selection&&null===e)return this.selection;if("start"===e||!0===e)return{from:0,to:0};if("end"===e){var t=this.state.doc;return{from:t.content.size,to:t.content.size}}return{from:e,to:e}}},{key:"focus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(this.view.focused&&null===t||!1===t)){var i=this.resolveSelection(t),a=i.from,n=i.to;this.setSelection(a,n),setTimeout((function(){return e.view.focus()}),10)}}},{key:"setSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.state,a=i.doc,n=i.tr,s=xt(e,0,a.content.size),r=xt(t,0,a.content.size),o=ht["TextSelection"].create(a,s,r),l=n.setSelection(o);this.view.dispatch(l)}},{key:"blur",value:function(){this.view.dom.blur()}},{key:"getSchemaJSON",value:function(){return JSON.parse(JSON.stringify({nodes:this.extensions.nodes,marks:this.extensions.marks}))}},{key:"getHTML",value:function(){var e=document.createElement("div"),t=vt["DOMSerializer"].fromSchema(this.schema).serializeFragment(this.state.doc.content);return e.appendChild(t),e.innerHTML}},{key:"getJSON",value:function(){return this.state.doc.toJSON()}},{key:"setContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,a=this.state,n=a.doc,s=a.tr,r=this.createDocument(e,i),o=ht["TextSelection"].create(n,0,n.content.size),l=s.setSelection(o).replaceSelectionWith(r,!1).setMeta("preventUpdate",!t);this.view.dispatch(l)}},{key:"clearContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setContent(this.options.emptyDocument,e)}},{key:"setActiveNodesAndMarks",value:function(){var e=this;this.activeMarks=Object.entries(this.schema.marks).reduce((function(t,i){var a=Object(at["a"])(i,2),n=a[0],s=a[1];return Object(ot["a"])(Object(ot["a"])({},t),{},Object(nt["a"])({},n,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(_t["d"])(e.state,s,t)})))}),{}),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce((function(t,i){var a=Object(at["a"])(i,2),n=a[0],s=a[1];return Object(ot["a"])(Object(ot["a"])({},t),{},Object(nt["a"])({},n,Object(_t["a"])(e.state,s)))}),{}),this.activeNodes=Object.entries(this.schema.nodes).reduce((function(t,i){var a=Object(at["a"])(i,2),n=a[0],s=a[1];return Object(ot["a"])(Object(ot["a"])({},t),{},Object(nt["a"])({},n,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(_t["e"])(e.state,s,t)})))}),{})}},{key:"getMarkAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.activeMarkAttrs[e]}},{key:"getNodeAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(ot["a"])({},Object(_t["c"])(this.state,this.schema.nodes[e]))}},{key:"registerPlugin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,i="function"===typeof t?t(e,this.state.plugins):[e].concat(Object(rt["a"])(this.state.plugins)),a=this.state.reconfigure({plugins:i});this.view.updateState(a)}},{key:"unregisterPlugin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e&&this.view.docView){var t=this.state.reconfigure({plugins:this.state.plugins.filter((function(t){return!t.key.startsWith("".concat(e,"$"))}))});this.view.updateState(t)}}},{key:"destroy",value:function(){this.view&&this.view.destroy()}},{key:"builtInExtensions",get:function(){return this.options.useBuiltInExtensions?[new Ct,new Rt,new Et]:[]}},{key:"state",get:function(){return this.view?this.view.state:null}},{key:"isActive",get:function(){return Object.entries(Object(ot["a"])(Object(ot["a"])({},this.activeMarks),this.activeNodes)).reduce((function(e,t){var i=Object(at["a"])(t,2),a=i[0],n=i[1];return Object(ot["a"])(Object(ot["a"])({},e),{},Object(nt["a"])({},a,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(e)})))}),{})}}]),i}(Nt),At={props:{editor:{default:null,type:Object},text:String},watch:{editor:{immediate:!0,handler:function(e){var t=this;e&&e.element&&this.$nextTick((function(){t.$el.appendChild(e.element.firstChild),e.setParentComponent(t)}))}}},render:function(e){return e("div")},beforeDestroy:function(){this.editor.element=this.$el}},It=function(){function e(t){var i=this,a=t.options;Object(lt["a"])(this,e),this.options=a,this.preventHide=!1,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.blurHandler=function(){i.preventHide?i.preventHide=!1:i.options.editor.emit("menubar:focusUpdate",!1)},this.options.editor.on("blur",this.blurHandler)}return Object(ct["a"])(e,[{key:"handleClick",value:function(){this.preventHide=!0}},{key:"destroy",value:function(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.options.editor.off("blur",this.blurHandler)}}]),e}(),Mt=function(e){return new ht["Plugin"]({key:new ht["PluginKey"]("menu_bar"),view:function(t){return new It({editorView:t,options:e})}})},Kt={props:{editor:{default:null,type:Object}},data:function(){return{focused:!1}},watch:{editor:{immediate:!0,handler:function(e){var t=this;e&&this.$nextTick((function(){e.registerPlugin(Mt({editor:e,element:t.$el})),t.focused=e.focused,e.on("focus",(function(){t.focused=!0})),e.on("menubar:focusUpdate",(function(e){t.focused=e}))}))}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor)}):null}},Ft=i("cd42"),Lt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"commands",value:function(e){var t=e.type,i=e.schema;return function(){return Object(Tt["m"])(t,i.nodes.paragraph)}}},{key:"keys",value:function(e){var t=e.type;return{"Ctrl->":Object(Tt["m"])(t)}}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["o"])(/^\s*>\s$/,t)]}},{key:"name",get:function(){return"blockquote"}},{key:"schema",get:function(){return{content:"block*",group:"block",defining:!0,draggable:!1,parseDOM:[{tag:"blockquote"}],toDOM:function(){return["blockquote",0]}}}}]),i}(Ft["b"]),$t=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"commands",value:function(e){var t=e.type,i=e.schema;return function(){return Object(Tt["k"])(t,i.nodes.list_item)}}},{key:"keys",value:function(e){var t=e.type,i=e.schema;return{"Shift-Ctrl-8":Object(Tt["k"])(t,i.nodes.list_item)}}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["o"])(/^\s*([-+*])\s$/,t)]}},{key:"name",get:function(){return"bullet_list"}},{key:"schema",get:function(){return{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:function(){return["ul",0]}}}}]),i}(Ft["b"]),zt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"keys",value:function(e){var t=e.type,i=Object(Tt["a"])(Tt["b"],(function(e,i){return i(e.tr.replaceSelectionWith(t.create()).scrollIntoView()),!0}));return{"Mod-Enter":i,"Shift-Enter":i}}},{key:"name",get:function(){return"hard_break"}},{key:"schema",get:function(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}}}}]),i}(Ft["b"]),Ut=(i("4d63"),function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"commands",value:function(e){var t=e.type,i=e.schema;return function(e){return Object(Tt["j"])(t,i.nodes.paragraph,e)}}},{key:"keys",value:function(e){var t=e.type;return this.options.levels.reduce((function(e,i){return Object(ot["a"])(Object(ot["a"])({},e),Object(nt["a"])({},"Shift-Ctrl-".concat(i),Object(Tt["f"])(t,{level:i})))}),{})}},{key:"inputRules",value:function(e){var t=e.type;return this.options.levels.map((function(e){return Object(Tt["i"])(new RegExp("^(#{1,".concat(e,"})\\s$")),t,(function(){return{level:e}}))}))}},{key:"name",get:function(){return"heading"}},{key:"defaultOptions",get:function(){return{levels:[1,2,3,4,5,6]}}},{key:"schema",get:function(){return{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:this.options.levels.map((function(e){return{tag:"h".concat(e),attrs:{level:e}}})),toDOM:function(e){return["h".concat(e.attrs.level),0]}}}}]),i}(Ft["b"])),Bt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"keys",value:function(e){var t=e.type;return{Enter:Object(Tt["h"])(t),Tab:Object(Tt["g"])(t),"Shift-Tab":Object(Tt["c"])(t)}}},{key:"name",get:function(){return"list_item"}},{key:"schema",get:function(){return{content:"paragraph block*",defining:!0,draggable:!1,parseDOM:[{tag:"li"}],toDOM:function(){return["li",0]}}}}]),i}(Ft["b"]),Gt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"commands",value:function(e){var t=e.type,i=e.schema;return function(){return Object(Tt["k"])(t,i.nodes.list_item)}}},{key:"keys",value:function(e){var t=e.type,i=e.schema;return{"Shift-Ctrl-9":Object(Tt["k"])(t,i.nodes.list_item)}}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["o"])(/^(\d+)\.\s$/,t,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order===+e[1]}))]}},{key:"name",get:function(){return"ordered_list"}},{key:"schema",get:function(){return{attrs:{order:{default:1}},content:"list_item+",group:"block",parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return 1===e.attrs.order?["ol",0]:["ol",{start:e.attrs.order},0]}}}}]),i}(Ft["b"]),Jt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"keys",value:function(e){var t=e.type;return{"Mod-b":Object(Tt["l"])(t)}}},{key:"commands",value:function(e){var t=e.type;return function(){return Object(Tt["l"])(t)}}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["d"])(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,t)]}},{key:"pasteRules",value:function(e){var t=e.type;return[Object(Tt["e"])(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,t)]}},{key:"name",get:function(){return"bold"}},{key:"schema",get:function(){return{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(e){return"normal"!==e.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(e){return/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}}],toDOM:function(){return["strong",0]}}}}]),i}(Ft["a"]),Wt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"keys",value:function(e){var t=e.type;return{"Mod-i":Object(Tt["l"])(t)}}},{key:"commands",value:function(e){var t=e.type;return function(){return Object(Tt["l"])(t)}}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["d"])(/(?:^|[^_])(_([^_]+)_)$/,t),Object(Tt["d"])(/(?:^|[^*])(\*([^*]+)\*)$/,t)]}},{key:"pasteRules",value:function(e){var t=e.type;return[Object(Tt["e"])(/_([^_]+)_/g,t),Object(Tt["e"])(/\*([^*]+)\*/g,t)]}},{key:"name",get:function(){return"italic"}},{key:"schema",get:function(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return["em",0]}}}}]),i}(Ft["a"]),qt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"keys",value:function(e){var t=e.type;return{"Mod-d":Object(Tt["l"])(t)}}},{key:"commands",value:function(e){var t=e.type;return function(){return Object(Tt["l"])(t)}}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["d"])(/~([^~]+)~$/,t)]}},{key:"pasteRules",value:function(e){var t=e.type;return[Object(Tt["e"])(/~([^~]+)~/g,t)]}},{key:"name",get:function(){return"strike"}},{key:"schema",get:function(){return{parseDOM:[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",getAttrs:function(e){return"line-through"===e}}],toDOM:function(){return["s",0]}}}}]),i}(Ft["a"]),Yt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"keys",value:function(e){var t=e.type;return{"Mod-u":Object(Tt["l"])(t)}}},{key:"commands",value:function(e){var t=e.type;return function(){return Object(Tt["l"])(t)}}},{key:"name",get:function(){return"underline"}},{key:"schema",get:function(){return{parseDOM:[{tag:"u"},{style:"text-decoration",getAttrs:function(e){return"underline"===e}}],toDOM:function(){return["u",0]}}}}]),i}(Ft["a"]),Xt=function(e){Object(dt["a"])(i,e);var t=Object(ut["a"])(i);function i(){return Object(lt["a"])(this,i),t.apply(this,arguments)}return Object(ct["a"])(i,[{key:"command",value:function(e){var t=e.type,i=e.attrs;return Object(Tt["n"])(t,i)}},{key:"inputRules",value:function(e){var t=e.type;return[Object(Tt["d"])(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,t)]}},{key:"name",get:function(){return"fontTextColor"}},{key:"schema",get:function(){return{attrs:{fontTextColor:{default:""}},parseDOM:[{style:"color",getAttrs:function(e){return-1!==e.indexOf("#")?{fontTextColor:e}:""}}],toDOM:function(e){return["span",{style:"color: ".concat(e.attrs.fontTextColor)},0]}}}}]),i}(Ft["a"]),Zt=i("b012"),Qt=i.n(Zt),ei={name:"text-tiptap",components:{EditorContent:At,EditorMenuBar:Kt},props:{text:String},data:function(){return{passageText:this.text,saveStatus:"Saved!",isTyping:!1,editor:new Dt({extensions:[new Lt,new $t,new zt,new Ut({levels:[1,2,3]}),new Bt,new Gt,new Jt,new Wt,new qt,new Yt,new Xt],content:this.text})}},beforeDestroy:function(){this.emitEdit(),this.editor.destroy()},computed:{editing:function(){return this.editor.focused},html:function(){return this.editor.getHTML()}},watch:{editing:function(){var e=this;this.editing&&(this.saveStatus="Saving...",this.isTyping=!0),this.editing||(this.saveStatus="Saving...",setTimeout((function(){e.isTyping=!1,e.saveStatus="Saved!"}),500)),this.editing||this.isTyping||(this.saveStatus="Saved!",this.isTyping=!1,this.stashEdit())},html:Qt()((function(){this.isTyping=!1,this.stashEdit(),this.saveStatus="Saved!"}),500)},methods:{emitEdit:function(){this.passageText=this.editor.getHTML(),this.$emit("evtPassageChange",this.passageText),this.saveStatus="Saved!"},stashEdit:function(){this.passageText=this.editor.getHTML()},switchEdit:function(){this.$emit("switchEdit",!1)}}},ti=ei,ii=(i("ff62"),Object(d["a"])(ti,tt,it,!1,null,"cf73ecc8",null)),ai=ii.exports;h()(ii,{VBtn:R["a"],VIcon:H["a"]});var ni={name:"text-editor",components:{"text-tiptap":ai},props:{dispText:String,linkText:String,theme:String},data:function(){return{editing:!1,editOptions:!1,textValue:this.dispText,linkTextValue:this.linkText,renderKey:0}},computed:{editLinkTextValue:function(){var e=this.linkTextValue;return e=e.replace(/\n/g,"<br>"),e=e.replace(/&quot;/g,'"'),e=e.replace(/&#39;/g,"'"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),"<p>"+e+"</p>"},emitLinkTextValue:function(){var e=this.linkTextValue;return e=e.replace(/<p>/g,""),e=e.replace(/<\/p>/g,"\n"),e=e.replace(/"/g,"&quot;"),e=e.replace(/'/g,"&#39;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e.trim()}},methods:{updatePassage:function(e){this.linkTextValue=e.replace(/<br>/g,"\n"),this.$emit("evtPassageChange",this.emitLinkTextValue),this.renderKey--},switchEdit:function(){this.editing=!this.editing,this.editOptions=!1,this.renderKey++},showEditOptions:function(){this.editOptions=!this.editOptions}}},si=ni,ri=(i("4767"),i("99d9")),oi=Object(d["a"])(si,Qe,et,!1,null,"f50f2734",null),li=oi.exports;h()(oi,{VBtn:R["a"],VCardText:ri["c"]});var ci=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("div",{key:this.audioRenderKey,staticStyle:{display:"flex","flex-direction":"row","justify-content":"start"},attrs:{id:"tabbed_list"}},e._l(this.audioList,(function(t,a){return i("page-element",{key:a,staticClass:"audio_elem",style:null!=e.audioData&&t.name==e.audioData.name?"border: solid 2px gray; background: whitesmoke;":"border: solid 2px lightgray;",attrs:{select:!0,showSelect:!1,name:t.name,fileName:t.data.fileName,audioData:t},on:{evtAdd:e.selectMedia,evtDelete:e.deleteMedia}})})),1)])},di=[],ui=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:this.selected&&this.showSelect?"border-radius: 5px; border: solid #F05E23; border-width: 1px":"",attrs:{id:"list_elem"}},[i("label",{attrs:{id:"list_elem"}},[e._v(e._s(this.name.replace("@",""))+": "+e._s(this.displayFileName))]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({attrs:{id:"list_delete",icon:""},on:{click:e.emitDelete}},"v-btn",n,!1),a),[i("v-icon",[e._v("mdi-delete")])],1)]}}])},[i("span",[e._v("Remove From Page")])]),i("div",{key:this.audioRenderKey+1},[i("audio",{ref:"player",staticStyle:{outline:"none"}},[i("source",{attrs:{src:e.getSrc}}),e._v(" Your browser does not support the audio element. ")]),i("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-around"},attrs:{id:"audio_controls"}},[i("v-btn",{attrs:{icon:""},on:{click:e.playPause}},[i("v-icon",[e._v(e._s(this.playing?"mdi-pause":"mdi-play"))])],1)],1)])],1)},hi=[],mi={name:"list-element",props:{name:String,fileName:String,select:Boolean,showSelect:Boolean,audioData:Object},data:function(){return{deleteOptions:!1,selected:!1,audioRenderKey:0,playing:!1}},computed:{getSrc:function(){return this.audioData.data.path.i},displayFileName:function(){return this.fileName.length>14?this.fileName.substr(0,14)+"...":this.fileName}},methods:{emitDelete:function(){this.$emit("evtDelete",{name:this.name})},playPause:function(){this.playing=!this.playing,this.playing?this.$refs.player.play():this.$refs.player.pause()}}},vi=mi,pi=(i("ecc6"),Object(d["a"])(vi,ui,hi,!1,null,"14ba628d",null)),fi=pi.exports;h()(pi,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var gi={name:"audio-item",components:{"page-element":fi},props:{audioList:Array},data:function(){return{audioData:null,audioRenderKey:0,volumeControls:!1,show:!1,playing:!1}},computed:{getSrc:function(){return this.audioData.data.path.i},name:function(){return this.audioData.name}},methods:{selectMedia:function(e){for(var t=0;t<this.audioList.length;t++)if(e.name==this.audioList[t].name&&(null!=this.audioData&&this.audioData.name!=e.name||null==this.audioData))return void(this.audioData=this.audioList[t])},deleteMedia:function(e){for(var t=null,i=0;i<this.audioList.length;i++)e.fileName==this.audioList[i].fileName&&(t=this.audioList[i]);this.$emit("removeMediaFromPage",t)}}},yi=gi,bi=(i("52a4"),Object(d["a"])(yi,ci,di,!1,null,"4f46258f",null)),_i=bi.exports,ki=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[this.displayable?i("img",{staticClass:"image",attrs:{src:this.src}}):i("div",{staticClass:"image"},[i("p",[e._v("No File Uploaded")])]),i("label",{style:"text-align:center; font-size:80%; color: "+this.imageData.data.color+";"},[e._v(e._s(this.name)+": "+e._s(this.fileName))]),i("br"),i("v-btn",{attrs:{icon:""},on:{click:e.removeMediaFromPage}},[i("v-icon",[e._v("mdi-delete")])],1),i("div",{staticClass:"spacing"})],1)},wi=[],Ni={name:"image-item",created:function(){},props:{imageData:Object},data:function(){return{}},computed:{src:function(){return this.imageData.data.path.i},name:function(){return this.imageData.name.replace("@","")},displayable:function(){return""!=this.imageData.data.path.i||null!=this.imageData.data.file},fileName:function(){return this.imageData.data.fileName.length>12?this.imageData.data.fileName.substr(0,12)+"...":this.imageData.data.fileName}},methods:{removeMediaFromPage:function(){this.$emit("removeMediaFromPage",this.imageData)}}},Vi=Ni,Si=(i("893e"),Object(d["a"])(Vi,ki,wi,!1,null,"2884d44e",null)),Oi=Si.exports;h()(Si,{VBtn:R["a"],VIcon:H["a"]});var xi={name:"page-layout",components:{"text-editor":li,"audio-list":_i,"image-list":Oi},props:{page:Ae.a,themeView:Boolean,imageVars:Map,audioVars:Map},data:function(){return{dispPassage:this.page.dispPassage,linkPassage:this.page.linkPassage,pageNum:this.page.pageNumber,pageTheme:this.page.theme,passageName:this.page.dispPassage.name,editName:!1,atStart:!0,delete:!1,renderKey:0}},computed:{starting:function(){return this.page.linkPassage.tags.includes("start")},hasAudioFiles:function(){return 0!=this.audioFiles.length},hasImages:function(){return 0!=this.imageFiles.length},audioFiles:function(){for(var e=[],t=0;t<this.page.audioFiles.length;t++)e.push({name:this.page.audioFiles[t].name,data:this.audioVars.get(this.page.audioFiles[t].name)});return e},imageFiles:function(){for(var e=[],t=0;t<this.page.imageFiles.length;t++)e.push({name:this.page.imageFiles[t].name,data:this.imageVars.get(this.page.imageFiles[t].name)});return e}},methods:{emitPage:function(e){this.$emit("evtNext",e),this.renderKey++},prevPage:function(){this.$emit("evtPrev"),this.renderKey--},updatePassageName:function(){this.passageName=document.getElementById("passageName").value;var e=this.page.linkPassage.name;this.$emit("evtPassageNameChange",{newName:this.passageName,prevName:e})},emitNewPassage:function(e){var t=this.linkPassage.tags.includes("variables");this.page.linkPassage.text=e,this.$emit("evtPassageChange",{name:this.linkPassage.name,text:e,isVariables:t})},emitStartingPage:function(){this.$emit("evtStart")},showEditName:function(){this.editName=!this.editName},showDelete:function(){this.delete=!this.delete},emitDelete:function(){this.$emit("evtDelete",{name:this.linkPassage.name})},emitStartPassage:function(){this.$emit("evtStartPage",{name:this.linkPassage.name})},removeImageFromPage:function(e){this.$emit("removeImageFromPage",e)},removeAudioFromPage:function(e){this.$emit("removeAudioFromPage",e)}},created:function(){this.linkPassage.tags.includes("start")?this.atStart=!0:this.atStart=!1},mounted:function(){this.$nextTick((function(){this.$emit("evtMinHeight",document.getElementById("page_layout").offsetHeight)}))}},Pi=xi,Ci=(i("0011"),Object(d["a"])(Pi,Xe,Ze,!1,null,"3cb23860",null)),Ti=Ci.exports;h()(Ci,{VBtn:R["a"],VIcon:H["a"],VTooltip:D["a"]});var Ei=i("1cf5"),Ri=i.n(Ei),ji=i("dec3"),Hi=i.n(ji),Di=i("8b4c"),Ai=i("6f5a"),Ii=i("bc3a"),Mi=i.n(Ii),Ki=i("2fc6"),Fi=i.n(Ki),Li=i("c4e3"),$i={name:"editor",data:function(){return{isLoggedIn:!1,userRef:null,storyRef:null,basePath:"",totalFileSize:0,maxStorageSize:15,status:"",storyName:"",storyPages:Array,storyVariables:Map,imageVariables:Map,audioVariables:Map,currentPage:1,pagesVisited:[],toolsWidth:"30%",pageWidth:"70%",contentHeight:"74vh",minHeight:"500px",hideItem:!1,toolButton:"mdi-minus",fullButton:"mdi-fullscreen",inFullMode:!1,themeView:!1,handles:{storyEditor:Hi.a,fileConverter:Ri.a},renderHints:{renderKey:1,variableRenderKey:1,themesRenderKey:1,passageRenderKey:1,gsoRenderKey:1,mediaRenderKey:1,hidden:!0,inVariableEditor:!0,inMediaEditor:!1},hi:"Hello",exportFile:""}},created:function(){var e=this;if(_.a.auth().currentUser&&(this.isLoggedIn=!0),this.isLoggedIn){var t=_.a.storage().ref(),i=_.a.auth().currentUser.email;this.userRef=t.child(i)}""!=this.$store.state.storyLocation?Mi.a.get(this.$store.state.storyLocation).then((function(t){null!=t.data?(e.loadContents(t.data),""!==sessionStorage.getItem("OGstoryPassages")&&null!==sessionStorage.getItem("OGstoryPassages")||sessionStorage.setItem("OGstoryPassages",JSON.stringify(e.handles.storyEditor.exportedStoryPages)),sessionStorage.setItem("createTemplate","yes"),console.log("Read Success")):console.log("Read Fail")})):""!=this.$store.state.storyContent&&(console.log(sessionStorage.getItem("storyContent")),this.loadContents(this.$store.state.storyContent),""===sessionStorage.getItem("OGstoryPassages")&&sessionStorage.setItem("OGstoryPassages",JSON.stringify(this.handles.storyEditor.exportedStoryPages)),this.regenerateStoryText({disp:!0})),this.isLoggedIn&&(""==this.storyName&&(this.storyName="Story Template"),this.storyRef=this.userRef.child(this.storyName),this.basePath=this.isLoggedIn.email+"/"+this.storyName+"/"),this.isLoggedIn&&this.storyRef.listAll().then(function(e){e.items.forEach(function(e){var t="@"+e.name.substring(0,e.name.indexOf("="));if(this.imageVariables.has(t)){var i=this.imageVariables.get(t),a={file:i.file,fileName:e.name.substring(e.name.indexOf("=")+1),path:e.getDownloadURL(),id:i.id,color:i.color,uploaded:!0};this.handles.storyEditor.setImageVariable(t,a),this.totalFileSize+=i.file.size/1024/1024}this.audioVariables.has(t)&&(i=this.audioVariables.get(t),a={file:i.file,fileName:e.name.substring(e.name.indexOf("=")+1),path:e.getDownloadURL(),id:i.id,color:i.color,uploaded:!0},this.handles.storyEditor.setAudioVariable(t,a),this.totalFileSize+=i.file.size/1024/1024),console.log(this.imageVariables),console.log(this.audioVariables)}.bind(this))}.bind(this))},components:{"var-sidebar":L,"media-sidebar":se,"themes-sidebar":Ve,"passage-sidebar":Ue,"page-layout":Ti,gso:Ye},watch:{status:Qt()((function(){this.status.includes("success")&&(this.status="",this.renderHints.renderKey++,this.checkRenderHints())}),3e3)},methods:{loadTwee:function(e){var t=this;console.log(e);var i=e[0],a=i.name.includes(".html");this.storyVariables=null,this.storyLinkPassages=null,this.storyDispPassages=null,this.handles.storyEditor=null,this.handles.fileConverter=null;var n=new FileReader;n.onload=function(){t.handles.fileConverter=new Ri.a(n.result,a),t.handles.storyEditor=new Hi.a(t.handles.fileConverter.story),t.storyVariables=t.handles.storyEditor.variables,t.imageVariables=t.handles.storyEditor.imageVariables,t.audioVariables=t.handles.storyEditor.audioVariables,t.storyPages=t.handles.storyEditor.exportedStoryPages,t.storyName=t.handles.storyEditor.baseStory.name,t.goToStart(),t.renderHints.renderKey++,t.renderHints.variableRenderKey++,t.renderHints.passageRenderKey++,t.renderHints.gsoRenderKey++,t.renderHints.hidden=!0,t.checkRenderHints(),sessionStorage.setItem("storyContent",n.result),sessionStorage.setItem("storyLocation",""),t.regenerateStoryText({disp:t.renderHints.hidden})},n.readAsText(i)},loadContents:function(e){this.storyVariables=null,this.storyLinkPassages=null,this.storyDispPassages=null,this.handles.storyEditor=null,this.handles.fileConverter=null,this.handles.fileConverter=new Ri.a(e,!1),this.handles.storyEditor=new Hi.a(this.handles.fileConverter.story),this.storyVariables=this.handles.storyEditor.variables,this.imageVariables=this.handles.storyEditor.imageVariables,this.audioVariables=this.handles.storyEditor.audioVariables,this.storyPages=this.handles.storyEditor.exportedStoryPages,this.storyName=this.handles.storyEditor.baseStory.name,this.goToStart(),this.renderHints.renderKey++,this.renderHints.variableRenderKey++,this.renderHints.passageRenderKey++,this.renderHints.gsoRenderKey++,this.renderHints.hidden=!0,this.checkRenderHints(),this.regenerateStoryText({disp:this.renderHints.hidden})},loadStoryTemplate:function(){var e=this;console.log("story template"),Mi.a.get("/stories/Story Template.twee").then((function(t){null!=t.data?(e.loadContents(t.data),sessionStorage.setItem("OGstoryPassages",JSON.stringify(e.handles.storyEditor.exportedStoryPages)),sessionStorage.setItem("createTemplate","yes"),console.log("Read Success")):console.log("Read Fail")})),this.regenerateStoryText({disp:this.renderHints.hidden})},replaceImage:function(e){this.handles.storyEditor.setImageVariable(e.name,e.data),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints();var t=this.imageVariables.get(e.name);if(this.isLoggedIn){var i=this.storyRef.child(e.name.replace("@","")+"="+e.oldData.fileName);if(i.delete().then((function(){this.status="Uploading "+e.data.fileName+"... please be patient :)"})),this.totalFileSize-=e.oldData.file.size/1024/1024,this.totalFileSize+=e.data.file.size/1024/1024,this.totalFileSize>this.maxStorageSize)this.totalFileSize-=e.data.file.size/1024/1024,this.totalFileSize+=e.oldData.file.size/1024/1024,this.status="Sorry! It looks like you've run out of storage space. Try uploading a smaller file!",this.handles.storyEditor.setImageVariable(e.name,e.oldData),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints();else{var a=this.storyRef.child(e.name.replace("@","")+"="+e.data.fileName);a.put(e.data.file).then(function(){this.status="Upload for "+e.data.fileName+" successful!";var i={file:e.data.file,fileName:e.data.fileName,path:a.getDownloadURL(),color:t.color,id:t.id,uploaded:!0};this.handles.storyEditor.setImageVariable(e.name,i),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),console.log(this.imageVariables)}.bind(this))}}},replaceAudio:function(e){this.handles.storyEditor.setAudioVariable(e.name,e.data),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints();var t=this.audioVariables.get(e.name);if(this.isLoggedIn){var i=this.storyRef.child(e.name.replace("@","")+"="+e.oldData.fileName);if(i.delete().then((function(){this.status="Uploading "+e.data.fileName+"... please be patient :)"})),this.totalFileSize-=e.oldData.file.size/1024/1024,this.totalFileSize+=e.data.file.size/1024/1024,this.totalFileSize>this.maxStorageSize)this.totalFileSize-=e.data.file.size/1024/1024,this.totalFileSize+=e.oldData.file.size/1024/1024,this.status="Sorry! It looks like you've run out of storage space. Try uploading a smaller file!",this.handles.storyEditor.setAudioVariable(e.name,e.oldData),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints();else{var a=this.storyRef.child(e.name.replace("@","")+"="+e.data.fileName);a.put(e.data.file).then(function(){this.status="Upload for "+e.data.fileName+" successful... thanks for waiting!";var i={file:e.data.file,fileName:e.data.fileName,path:a.getDownloadURL(),color:t.color,id:t.id,uploaded:!0};this.handles.storyEditor.setAudioVariable(e.name,i),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),console.log(this.audioVariables)}.bind(this))}}},replaceImageName:function(e){var t=this.handles.storyEditor.changeImageVariableName(e);this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints();var i=e.fileName;if(this.isLoggedIn&&t){var a=this.storyRef.child(e.prevName.replace("@","")+"="+i);a.delete();var n=this.imageVariables.get(e.newName),s=this.storyRef.child(e.newName.replace("@","")+"="+i);s.put(n.file).then(function(){this.status="Your changes were saved successfully!",n.path.i.includes("blob")&&URL.revokeObjectURL(n.path.i);var t={file:n.file,fileName:i,path:s.getDownloadURL(),color:n.color,id:n.id,uploaded:!0};this.handles.storyEditor.setImageVariable(e.newName,t),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints()}.bind(this))}},replaceAudioName:function(e){var t=this.handles.storyEditor.changeAudioVariableName(e);this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints();var i=e.fileName;if(this.isLoggedIn&&t){var a=this.storyRef.child(e.prevName.replace("@","")+"="+i);a.delete();var n=this.audioVariables.get(e.newName),s=this.storyRef.child(e.newName.replace("@","")+"="+i);s.put(n.file).then(function(){this.status="Your changes were saved successfully!",n.path.i.includes("blob")&&URL.revokeObjectURL(n.path.i);var t={file:n.file,fileName:i,path:s.getDownloadURL(),color:n.color,id:n.id,uploaded:!0};this.handles.storyEditor.setAudioVariable(e.newName,t),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),console.log(this.audioVariables)}.bind(this))}},addImageVariable:function(e){for(var t=0;t<e.length;t++)this.handles.storyEditor.addImageVariable(e[t]);this.handles.storyEditor.reparseMedia(),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),this.isLoggedIn&&this.imageVariables.forEach(function(e,t){if(this.status="Uploading "+e.fileName+"... please be patient :)",console.log("Uploaded:"+e.uploaded),0==e.uploaded){var i=this.storyRef.child(t.replace("@","")+"="+e.fileName),a=e.file;this.totalFileSize+=a.size/1024/1024,this.totalFileSize>this.maxStorageSize?(this.totalFileSize-=a.size/1024/1024,this.status="Sorry! It looks like you've run out of storage space. Try uploading smaller files!",this.removeImageVariable({name:t,fileName:e.fileName,file:e.file})):i.put(a).then(function(){this.status="Upload for "+e.fileName+" successful... thanks for waiting!",e.path.i.includes("blob")&&URL.revokeObjectURL(e.path.i);var a={file:e.file,fileName:e.fileName,path:i.getDownloadURL(),color:e.color,id:e.id,uploaded:!0};this.handles.storyEditor.setImageVariable(t,a),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints()}.bind(this))}}.bind(this))},addAudioVariable:function(e){for(var t=0;t<e.length;t++)this.handles.storyEditor.addAudioVariable(e[t]);this.handles.storyEditor.reparseMedia(),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),this.isLoggedIn&&this.audioVariables.forEach(function(e,t){if(this.status="Uploading "+e.fileName+"... please be patient :)",console.log("Uploaded:"+e.uploaded),0==e.uploaded){var i=this.storyRef.child(t.replace("@","")+"="+e.fileName),a=e.file;this.totalFileSize+=a.size/1024/1024,this.totalFileSize>this.maxStorageSize?(this.totalFileSize-=a.size/1024/1024,this.status="Sorry! It looks like you've run out of storage space. Try uploading smaller files!",this.removeAudioVariable({name:t,fileName:e.fileName,file:e.file})):i.put(a).then(function(){this.status="Upload for "+e.fileName+" successful... thanks for waiting!",e.path.i.includes("blob")&&URL.revokeObjectURL(e.path.i);var a={file:e.file,fileName:e.fileName,path:i.getDownloadURL(),color:e.color,id:e.id,uploaded:!0};this.handles.storyEditor.setAudioVariable(t,a),console.log(this.audioVariables),console.log(this.totalFileSize),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints()}.bind(this))}}.bind(this))},removeImageVariable:function(e){if(this.handles.storyEditor.deleteImageVariable(e),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),this.isLoggedIn){var t=this.storyRef.child(e.name.replace("@","")+"="+e.fileName);t.delete().then((function(){console.log("DELETED")})),this.writeToStorage(),this.totalFileSize-=e.file.size/1024/1024}},removeAudioVariable:function(e){if(this.handles.storyEditor.deleteAudioVariable(e),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.mediaRenderKey++,this.checkRenderHints(),this.isLoggedIn){var t=this.storyRef.child(e.name.replace("@","")+"="+e.fileName);t.delete().then((function(){console.log("DELETED")})),this.writeToStorage(),this.totalFileSize-=e.file.size/1024/1024}},addImageToPage:function(e){var t={name:e.name,pageName:this.storyPages[this.currentPage-1].pageName};this.handles.storyEditor.addImageToPage(t),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},addAudioToPage:function(e){var t={name:e.name,pageName:this.storyPages[this.currentPage-1].pageName};this.handles.storyEditor.addAudioToPage(t),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},removeImageFromPage:function(e){var t={name:e.name,pageName:this.storyPages[this.currentPage-1].pageName};this.handles.storyEditor.removeImageFromPage(t),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},removeAudioFromPage:function(e){var t={name:e.name,pageName:this.storyPages[this.currentPage-1].pageName};this.handles.storyEditor.removeAudioFromPage(t),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},nextPage:function(e){this.pagesVisited.push(this.currentPage),e.location<this.storyPages.length&&(this.currentPage=e.location+1),this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},goToStart:function(){this.pagesVisited=[];for(var e=0;this.storyPages.length;e++)if(this.storyPages[e].linkPassage.tags.includes("start")){this.currentPage=e+1;break}this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},setStartPage:function(e){this.handles.storyEditor.setStartPage(e),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},prevPage:function(){return this.pagesVisited.length>0&&(this.currentPage=this.pagesVisited[this.pagesVisited.length-1],this.pagesVisited.pop(),this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints(),!0)},addPage:function(e){this.storyPages[this.currentPage-1].linkPassage.text+="\n[["+e.name+"]]";var t=this.storyPages[this.currentPage-1].linkPassage.tags.includes("variables");this.updatePassage({name:this.storyPages[this.currentPage-1].linkPassage.name,text:this.storyPages[this.currentPage-1].linkPassage.text,isVariables:t}),this.handles.storyEditor.addPage({name:e.name,prevLink:this.storyPages[this.currentPage-1].linkPassage.name}),this.writeToStorage(),this.goToPage(e)},goToPage:function(e){for(var t=0;this.storyPages.length;t++)if(this.storyPages[t].linkPassage.name==e.name){this.currentPage=t+1;break}this.renderHints.renderKey++,this.checkRenderHints()},showThemes:function(){this.themeView=!0,this.regenerateStoryText({disp:this.renderHints.hidden}),this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},hideThemes:function(){this.themeView=!1,this.regenerateStoryText({disp:this.renderHints.hidden}),this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},setTheme:function(e){this.storyPages[this.currentPage-1].theme="color:"+e.textColor+";background-color:"+e.bgColor,this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},setThemeAll:function(e){for(var t=0;t<this.storyPages.length;t++)this.storyPages[t].theme="color:"+e.textColor+";background-color:"+e.bgColor;this.renderHints.renderKey++,this.renderHints.themesRenderKey++,this.checkRenderHints()},setVariable:function(e){this.handles.storyEditor.setTextVariable(e.name,e.value),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},setVariableName:function(e){this.handles.storyEditor.changeTextVariableName(e),this.writeToStorage(),this.renderHints.variableRenderKey++,this.renderHints.renderKey++,this.checkRenderHints()},deleteVariable:function(e){this.handles.storyEditor.deleteTextVariable(e),this.writeToStorage(),this.renderHints.variableRenderKey++,this.renderHints.renderKey++,this.checkRenderHints()},regenerateStoryText:function(e){this.renderHints.hidden=e.disp,this.handles.storyEditor.generateStoryText(this.renderHints.hidden,this.renderHints.inVariableEditor,this.renderHints.inMediaEditor),this.storyVariables=this.handles.storyEditor.variables,this.imageVariables=this.handles.storyEditor.imageVariables,this.audioVariables=this.handles.storyEditor.audioVariables,this.storyPages=this.handles.storyEditor.exportedStoryPages,this.storyName=this.handles.storyEditor.baseStory.name,this.renderHints.renderKey++,this.checkRenderHints()},addNewVariable:function(e){this.handles.storyEditor.addTextVariable(e),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.variableRenderKey++,this.checkRenderHints()},addLink:function(e){this.handles.storyEditor.addLink({pageName:this.storyPages[this.currentPage-1].pageName,name:e.name}),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.passageRenderKey++,this.checkRenderHints()},removeLink:function(e){this.handles.storyEditor.removeLink(e),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},updatePassage:function(e){this.handles.storyEditor.setPassage(e.name,e.text),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.passageRenderKey++,e.isVariables&&this.renderHints.variableRenderKey++,this.checkRenderHints()},updatePassageName:function(e){this.handles.storyEditor.changePassageName(e),this.writeToStorage(),this.renderHints.renderKey++,this.renderHints.passageRenderKey++,this.checkRenderHints()},deletePassage:function(e){this.handles.storyEditor.deletePassage(e),this.writeToStorage(),this.renderHints.passageRenderKey++,this.prevPage()||this.goToStart()},changeStoryName:function(e){this.handles.storyEditor.changeStoryName(e),this.writeToStorage(),this.renderHints.renderKey++,this.checkRenderHints()},downloadStoryTwee:function(){var e=this.handles.storyEditor.generateSaveStory();this.handles.fileConverter.story=e;var t=this.handles.fileConverter.twee(),i=new Blob([t],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(i),a.target="_blank",a.setAttribute("download",this.handles.storyEditor.baseStory.name+".twee"),a.click(),URL.revokeObjectURL(a.href)},saveStoryToProfile:function(){var e=this.handles.storyEditor.generateSaveStory();this.handles.fileConverter.story=e;var t=this.handles.fileConverter.twee(),i=new Date,a={text:t,dateUpdated:i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear(),OGstory:sessionStorage.getItem("OGstoryPassages")};k["c"].ref("accounts/"+_.a.auth().currentUser.uid+"/drafts/"+this.handles.storyEditor.baseStory.name)?k["c"].ref("accounts/"+_.a.auth().currentUser.uid+"/drafts/"+this.handles.storyEditor.baseStory.name).update(a):k["c"].ref("accounts/"+_.a.auth().currentUser.uid+"/drafts/"+this.handles.storyEditor.baseStory.name).push(a),alert("Your story was saved successfully!")},getExportFile:function(){var e=this.handles.storyEditor.generatePublishStory();this.handles.fileConverter.story=e;var t=this.handles.fileConverter.twee();this.$store.commit("updateStoryPublish",t)},downloadStory:function(){var e=this.handles.storyEditor.generateViewStory(!0);this.handles.fileConverter.story=e;var t=this.handles.fileConverter.html(this.handles.storyEditor.css,"");e=this.handles.storyEditor.generateSaveStory(),this.handles.fileConverter.story=e;var i=this.handles.fileConverter.twee(),a=new Li;a.file(this.storyName+".html",t),a.file(this.storyName+".twee",i),a.file("readMe.txt","To view the story, double click on the html file.\nIf the user wants to re-edit the story, they must upload the .twee file to our website.\nCreate an account to save stories, download stories and more!");var n=this.storyName;a.generateAsync({type:"blob"}).then((function(e){Fi.a.saveAs(e,n+".zip")}))},viewStoryHTML:function(){var e=this.handles.storyEditor.generateViewStory(!0);this.handles.fileConverter.story=e;var t=this.handles.fileConverter.html(this.handles.storyEditor.css,""),i=document.createElement("a");i.href=URL.createObjectURL(new Blob([t],{type:"text/html"})),i.target="_blank",i.click(),URL.revokeObjectURL(i.href)},publishStoryType:function(){var e=this.checkUniqueStory();"yes"===sessionStorage.getItem("createTemplate")&&!0===e&&this.checkUniqueTemplate()},checkUniqueTemplate:function(){var e=this,t=!0,a=i("f3b2"),n=new a.Client({nodes:[{host:"av2xrki6y54hl3wbp-1.a1.typesense.net",port:"443",protocol:"https"}],apiKey:"I1RDnpfBxdpllDchtj7gslzsqwpmnvmi"});n.collections("stories").retrieve().then((function(i){for(var a=i.num_documents,s=function(i){n.collections("stories").documents(i.toString()).retrieve().then((function(n){for(var s=new Ri.a(n.text,!1),r=new Hi.a(s.story),o="",l="",c=0;c<r.exportedStoryPages.length;c++)o+=r.exportedStoryPages[c].linkPassage.text;for(var d=0;d<e.storyPages.length;d++)l+=e.storyPages[d].linkPassage.text;if(r.exportedStoryPages.length<e.storyPages.length)for(var u=r.exportedStoryPages.length;u<e.storyPages.length;u++){var h=e.storyPages[u].linkPassage.text.indexOf("[["),m=e.storyPages[u].linkPassage.text.indexOf("]]"),v=e.storyPages[u].linkPassage.text;if(-1!=h){var p=e.storyPages[u].linkPassage.text.substring(h,m+2);v=e.storyPages[u].linkPassage.text.replace(p,"")}if(e.storyPages[u].linkPassage.text.includes("This is a new passage. Edit it to create your own story!")||""===v.replace(/\s/g,""))return void alert("Please edit content in new passages.");l+=v}var f=e.similarity(o,l);if(f>.75)return t=!1,void alert("Story template is too similar to existing template. Please submit a unique story template.");f<=.75&&i===a-2&&!0===t&&alert("Story template is unique and is ready to be published!")}))},r=0;r<a-1;r++)s(r)}))},checkUniqueStory:function(){for(var e="",t="",i=0;i<JSON.parse(sessionStorage.getItem("OGstoryPassages")).length;i++)e+=JSON.parse(sessionStorage.getItem("OGstoryPassages"))[i].linkPassage.text;for(var a=0;a<this.storyPages.length;a++)t+=this.storyPages[a].linkPassage.text;if(JSON.parse(sessionStorage.getItem("OGstoryPassages")).length<this.storyPages.length)for(var n=JSON.parse(sessionStorage.getItem("OGstoryPassages")).length;n<this.storyPages.length;n++){var s=this.storyPages[n].linkPassage.text.indexOf("[["),r=this.storyPages[n].linkPassage.text.indexOf("]]"),o=this.storyPages[n].linkPassage.text;if(-1!=s){var l=this.storyPages[n].linkPassage.text.substring(s,r+2);o=this.storyPages[n].linkPassage.text.replace(l,"")}if(this.storyPages[n].linkPassage.text.includes("This is a new passage. Edit it to create your own story!")||""===o.replace(/\s/g,""))return alert("Please edit content in new passages."),!1;t+=o}var c=this.similarity(e,t);return console.log(c),c>.75?(alert("Story is too similar to the original. Please submit a unique story."),!1):"yes"==sessionStorage.getItem("createTemplate")||void alert("Story is unique and is ready to be published!")},similarity:function(e,t){var i=e.toLowerCase().replace(/\s/g,""),a=t.toLowerCase().replace(/\s/g,"");e.length<t.length&&(i=t,a=e);var n=i.length;return 0==n?1:(n-this.editDistance(i,a))/parseFloat(n)},editDistance:function(e,t){for(var i=new Array,a=0;a<=e.length;a++){for(var n=a,s=0;s<=t.length;s++)if(0==a)i[s]=s;else if(s>0){var r=i[s-1];e.charAt(a-1)!=t.charAt(s-1)&&(r=Math.min(Math.min(r,n),i[s])+1),i[s-1]=n,n=r}a>0&&(i[t.length]=n)}return i[t.length]},writeToStorage:function(){var e=this.handles.storyEditor.generateSaveStory();this.handles.fileConverter.story=e;var t=this.handles.fileConverter.twee();sessionStorage.setItem("storyContent",t),sessionStorage.setItem("storyLocation",""),this.handles.storyEditor.generateStoryText(this.renderHints.hidden,this.renderHints.inVariableEditor,this.renderHints.inMediaEditor),this.storyVariables=this.handles.storyEditor.variables,this.imageVariables=this.handles.storyEditor.imageVariables,this.audioVariables=this.handles.storyEditor.audioVariables,this.storyPages=this.handles.storyEditor.exportedStoryPages,this.storyName=this.handles.storyEditor.baseStory.name},checkRenderHints:function(){this.renderHints.renderKey>10&&(this.renderHints.renderKey=1),this.renderHints.variableRenderKey>10&&(this.renderHints.variableRenderKey=1),this.renderHints.themesRenderKey>10&&(this.renderHints.themesRenderKey=1),this.renderHints.passageRenderKey>10&&(this.renderHints.passageRenderKey=1),this.renderHints.gsoRenderKey>10&&(this.renderHints.gsoRenderKey=1),this.renderHints.mediaRenderKey>10&&(this.renderHints.mediaRenderKey=1)},hideTools:function(){"mdi-minus"==this.toolButton?(this.toolsWidth="10%",this.pageWidth="90%",this.hideItem=!0,this.toolButton="mdi-plus"):(this.toolsWidth="30%",this.pageWidth="70%",this.hideItem=!1,this.toolButton="mdi-minus")},goFullScreen:function(){this.inFullMode?(this.$emit("evtExitFull"),this.inFullMode=!1,this.fullButton="mdi-fullscreen",this.contentHeight="74vh"):(this.$emit("evtGoFull"),this.inFullMode=!0,this.fullButton="mdi-fullscreen-exit",this.contentHeight="100vh")},setMinHeight:function(e){this.minHeight=e}},beforeDestroy:function(){console.log("Destroyed"),this.handles.storyEditor.destroy()},mixins:[Di["a"],Ai["a"]]},zi=$i,Ui=(i("3690"),i("7701"),i("b0af")),Bi=i("2fa4"),Gi=i("71a3"),Ji=i("c671"),Wi=i("fe57"),qi=i("71d9"),Yi=i("2a7f"),Xi=Object(d["a"])(zi,N,V,!1,null,"f6e07f7c",null),Zi=Xi.exports;h()(Xi,{VBtn:R["a"],VCard:Ui["a"],VCardText:ri["c"],VIcon:H["a"],VSpacer:Bi["a"],VTab:Gi["a"],VTabItem:Ji["a"],VTabs:Wi["a"],VToolbar:qi["a"],VToolbarTitle:Yi["a"],VTooltip:D["a"]});var Qi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("NavBar"),e.isSubmitted||e.noStory?e._e():i("form",[i("h2",[e._v("Add a New Story")]),i("v-text-field",{attrs:{"error-messages":e.nameErrors,counter:30,label:"Story Title",required:""},model:{value:e.newStory.title,callback:function(t){e.$set(e.newStory,"title",t)},expression:"newStory.title"}}),i("v-text-field",{attrs:{"error-messages":e.bodyErrors,label:"Synopsis",required:""},model:{value:e.newStory.synopsis,callback:function(t){e.$set(e.newStory,"synopsis",t)},expression:"newStory.synopsis"}}),i("v-select",{attrs:{items:e.allTags,multiple:!0,"error-messages":e.selectErrors,label:"Tags",required:""},model:{value:e.newStory.tags,callback:function(t){e.$set(e.newStory,"tags",t)},expression:"newStory.tags"}}),i("v-text-field",{attrs:{label:"Add New Tag",required:""},on:{click:function(t){return e.clickAddTag()}},model:{value:e.newTag,callback:function(t){e.newTag=t},expression:"newTag"}}),e.addingTag?i("v-btn",{attrs:{disabled:!e.addedTag},on:{click:function(t){e.addTag(e.newTag),e.updateTags()}}},[e._v("Add Tag")]):e._e(),i("br"),i("v-btn",{attrs:{disabled:!e.formComplete},on:{click:function(t){return e.addStory(e.newStory)}}},[e._v("Submit Story")])],1),e.noStory?i("h2",[e._v("No story has been chosen, please choose a story to submit.")]):e._e(),e.isSubmitted?i("h2",[e._v("Your story has been submitted!")]):e._e()],1)},ea=[],ta=new Date,ia={components:{NavBar:r["a"]},data:function(){return{allTags:[],newStory:{title:"",author:_.a.auth().currentUser.displayName,synopsis:"",tags:[],views:0,dateNow:Date.now(),dateAdded:ta.getMonth()+1+"/"+ta.getDate()+"/"+ta.getFullYear(),text:"",creator:_.a.auth().currentUser.email},nameErrors:"",bodyErrors:"",authorErrors:"",selectErrors:"",newTag:"",noStory:!1,isSubmitted:!1,addingTag:!1}},methods:{clickAddTag:function(){this.addingTag=!0},updateTags:function(){this.allTags=this.getTags()}},created:function(){this.newStory.text=this.$store.state.storyToPublish,0===this.newStory.text.length&&(this.noStory=!0),this.allTags=this.getTags()},mounted:function(){},computed:{formComplete:function(){return this.newStory.tags.length>0&&this.newStory.title.length<=30&&(this.newStory.title&&this.newStory.author&&this.newStory.synopsis&&this.newStory.text)},addedTag:function(){return this.newTag.length>0}},mixins:[Di["a"],x["a"]]},aa=ia,na=(i("c93f"),i("b974")),sa=i("8654"),ra=Object(d["a"])(aa,Qi,ea,!1,null,"bcab65f4",null),oa=ra.exports;h()(ra,{VApp:m["a"],VBtn:R["a"],VSelect:na["a"],VTextField:sa["a"]});var la=[{path:"/",name:"editor",component:Zi},{path:"/addStory",name:"addStory",component:oa}];a["a"].mixin(y["a"]),a["a"].use(w["a"]),a["a"].config.productionTip=!1;var ca,da=new w["a"]({routes:la});_.a.auth().onAuthStateChanged((function(){ca||(ca=new a["a"]({vuetify:f["a"],store:g["a"],router:da,render:function(e){return e(p)}}).$mount("#app"))}))},a648:function(e,t,i){"use strict";var a=i("9e7d"),n=i.n(a);n.a},a7db:function(e,t,i){},a9f3:function(e,t,i){},ade2:function(e,t,i){"use strict";var a=i("4f67"),n=i.n(a);n.a},b4d2:function(e,t,i){},b52d:function(e,t,i){},b6a6:function(e,t,i){"use strict";var a=i("c1cc"),n=i.n(a);n.a},bfca:function(e,t,i){},c1cc:function(e,t,i){},c33c:function(e,t,i){"use strict";var a=i("b4d2"),n=i.n(a);n.a},c612:function(e,t,i){},c83e:function(e,t,i){"use strict";var a=i("c612"),n=i.n(a);n.a},c93f:function(e,t,i){"use strict";var a=i("d9b3"),n=i.n(a);n.a},d9b3:function(e,t,i){},e8ba:function(e,t,i){},ecc6:function(e,t,i){"use strict";var a=i("5e4d"),n=i.n(a);n.a},f242:function(e,t,i){},ff62:function(e,t,i){"use strict";var a=i("8443"),n=i.n(a);n.a}});
//# sourceMappingURL=editor.de33cd7c.js.map